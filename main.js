!function(){"use strict";var e={717:function(e,t,s){e.exports=s.p+"a086f758840ae814ecde.svg"}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}s.p="",function(){var e=s(717);function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e,s,r,o,n,i){t(this,"likeCard",(e=>{this._likes=e.likes,this._element.querySelector(".heart").classList.add("heart_active"),this._likesCounter.textContent=e.likes.length})),t(this,"removeLike",(e=>{this._likes=e.likes,this._element.querySelector(".heart").classList.remove("heart_active"),this._likesCounter.textContent=e.likes.length})),this._text=e.name,this._link=e.link,this._id=e._id,this._likes=e.likes,this._likesCount=e.likes.length,this._owner=e.owner._id,this._user=s,this._template=document.getElementById(r),this._handleCardClick=o,this._handleDeleteCard=n,this._handleLikeButton=i}_getCardData(){return this._template.content.querySelector(".photos-grid__card").cloneNode(!0)}isCardLiked(){return this._likes.some((e=>e._id===this._user))}generateCard(){return this._element=this._getCardData(),this._cardPhoto=this._element.querySelector(".photos-grid__photo"),this._cardCaption=this._element.querySelector(".photos-grid__location"),this._likesCounter=this._element.querySelector(".photos-grid__like-counter"),this._trashIcon=this._element.querySelector(".photos-grid__trash"),this._likesCounter.textContent=this._likesCount,this._cardPhoto.src=this._link,this._cardPhoto.alt=this._text,this._cardCaption.textContent=this._text,this._owner!==this._user&&this._trashIcon.classList.add("photos-grid__trash_disables"),this.isCardLiked()&&this._element.querySelector(".heart").classList.add("heart_active"),this._setEventListeners(),this._element}deleteCard(){this._element.remove(),this._element=null}_setEventListeners(){this._element.querySelector(".heart").addEventListener("click",(()=>this._handleLikeButton(this._id))),this._element.querySelector(".photos-grid__trash").addEventListener("click",(()=>this._handleDeleteCard(this._id))),this._element.querySelector(".photos-grid__photo").addEventListener("click",this._handleCardClick)}}class o{constructor(e,t){this._config=e,this._form=document.querySelector(t)}enableValidation(){this._inputList=[...this._form.querySelectorAll(this._config.inputSelector)],this._buttonElement=this._form.querySelector(this._config.submitButtonSelector),this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e),this._toggleButtonState()})),this._form.reset()}_showInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add(this._config.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class i{constructor(e){n(this,"_handleEscClose",(e=>{"Escape"===e.key&&this._popup.classList.remove("popup_opened")})),n(this,"_handleClickOverlayClose",(e=>{e.target==e.currentTarget&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),this._popup.addEventListener("mousedown",this._handleClickOverlayClose),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),this._popup.removeEventListener("mousedown",this._handleClickOverlayClose),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.querySelector(".popup__close-button").addEventListener("click",(()=>this.close()))}}class a extends i{constructor(e,t){super(e),this._handleFormSubmit=t}_getInputValues(){const e={};return this._popup.querySelectorAll(".popup__input").forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._popup.querySelector(".popup__save-button");this._handleFormSubmit(this._getInputValues(),t)}))}close(){this._popupForm.reset(),super.close()}}const h={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_inactive",inputErrorClass:"popup__input_state_error",errorClass:"popup__input-error_active"},_=new class extends i{getMessage(e,t){this._messageField=this._popup.querySelector(e),this._messageField.textContent=t}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this.close()}))}}(".popup_type_error");_.setEventListeners();const p=new class{constructor(e,t){let{baseUrl:s,headers:r,errorFunction:o}=t;this._customFetch=e,this._errorFunction=o,this._baseUrl=s,this._headers=r}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers},this._errorFunction)}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers},this._errorFunction)}updateUserInfo(e){return this._customFetch("".concat(this._baseUrl,"/usrs/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})},this._errorFunction)}setNewCard(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})},this._errorFunction)}deleteCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers},this._errorFunction)}addLike(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers},this._errorFunction)}removeLike(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers},this._errorFunction)}setUserAvatar(e){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})},this._errorFunction)}}(((e,t,s)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>{console.log(e),s(e)}))),{baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"3e63b17a-6497-4226-90cf-4d7937b7aba1","Content-Type":"application/json"},errorFunction:e=>{_.getMessage(".popup__text",e),_.open()}}),c=document.getElementById("profile-avatar");document.getElementById("profile-avatar-edit").src=e;const u=new class{constructor(e,t,s,r){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._formNameInput=document.querySelector(s),this._formJobInput=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserInfo(e){this._formNameInput.value=e.name,this._formJobInput.value=e.about,this._nameElement.textContent=e.name,this._jobElement.textContent=e.about}}(".profile__name",".profile__title",".popup__input_type_name",".popup__input_type_job");let l;Promise.all([p.getUserInfo(),p.getInitialCards()]).then((e=>{let[t,s]=e;l=t._id;const r={name:t.name,about:t.about};u.setUserInfo(r),c.style.backgroundImage="url(".concat(t.avatar,")"),b.renderer(s)}));const d=new a(".popup_type_edit-profile",((e,t)=>{t.textContent="Saving...",p.updateUserInfo(e).then((e=>u.setUserInfo(e))).then(d.close()).then(t.textContent="Save")}));d.setEventListeners();const m=new o(h,".popup__form_type_edit-profile");m.enableValidation(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{m.resetValidation(),u.setUserInfo(u.getUserInfo()),d.open()}));const v=new a(".popup_type_edit-avatar",((e,t)=>{t.textContent="Saving...",p.setUserAvatar(e).then((e=>{c.style.backgroundImage="url(".concat(e.avatar,")")})).then(v.close()).then(t.textContent="Save")}));v.setEventListeners();const g=new o(h,".popup__form_type_edit-avatar");g.enableValidation(),document.querySelector(".profile__avatar-cover").addEventListener("click",(()=>{g.resetValidation(),v.open()}));const C=new class extends i{constructor(e,t,s){super(e),this._source=t,this._caption=s}open(e){super.open(),this._source=e.link,this._caption=e.name,this._popupImage=this._popup.querySelector(".picture-popup__popup-image"),this._popupCaption=this._popup.querySelector(".picture-popup__popup-text"),this._popupImage.src=this._source,this._popupImage.alt=this._caption,this._popupCaption.textContent=this._caption}}(".picture-popup"," "," ");C.setEventListeners();const f=new class extends i{getTask(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(),this.close()}))}}(".popup_type_delete-card");f.setEventListeners();const E=e=>{const t=new r(e,l,"card-template",(()=>{C.open(e)}),(e=>{f.open(),f.getTask((()=>{p.deleteCard(e),t.deleteCard()}))}),(e=>{t.isCardLiked()?p.removeLike(e).then((e=>{t.removeLike(e)})):p.addLike(e).then((e=>{t.likeCard(e)}))})),s=t.generateCard();b.addItem(s)},b=new class{constructor(e,t){this._renderItem=e,this._container=document.querySelector(t)}renderer(e){e.forEach((e=>{this._renderItem(e)}))}addItem(e){this._container.prepend(e)}}(E,".photos-grid__list"),y=new a(".popup_type_add-card",((e,t)=>{t.textContent="Creating...",p.setNewCard(e).then((e=>{E(e)})).then(y.close()).then(t.textContent="Create")}));y.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",(()=>{L.resetValidation(),y.open()}));const L=new o(h,".popup__form_type_add-card");L.enableValidation()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZQyxHQUN0QnhMLEtBQUt5TCxZQUFjRixFQUNuQnZMLEtBQUswTCxXQUFhckssU0FBU2pCLGNBQWNvTCxHQUUzQ3ZCLFNBQVMwQixHQUNQQSxFQUFNckksU0FBU3NJLElBQ2I1TCxLQUFLeUwsWUFBWUcsTUFHckJOLFFBQVFPLEdBQ043TCxLQUFLMEwsV0FBV0ksUUFBUUQsS05tS0VaLEVBQVksc0JBSXBDYyxFQUFtQixJQUFJNUcsRUFEUix3QkFDb0MsQ0FBQ0ssRUFBWUksS0FDcEVBLEVBQWFwRixZQUFjLGNBQzNCNEYsRUFDR2tCLFdBQVc5QixHQUNYd0MsTUFBTUMsSUFDTGdELEVBQVdoRCxNQUVaRCxLQUFLK0QsRUFBaUJsSCxTQUN0Qm1ELEtBQU1wQyxFQUFhcEYsWUFBYyxhQUV0Q3VMLEVBQWlCN0csb0JBU0s3RCxTQUFTakIsY0FBYyx3QkFDL0JtQyxpQkFBaUIsU0FQUCxLQUN0QnlKLEVBQXFCM0ksa0JBQ3JCMEksRUFBaUJqSCxVQVFuQixNQUNNa0gsRUFBdUIsSUFBSXhKLEVBQWNxRCxFQUQzQiw4QkFFcEJtRyxFQUFxQm5KLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhNZXNzYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJkIEdlbmVyYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHVzZXIsIHRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNhcmQsIGhhbmRsZUxpa2VCdXR0b24pIHtcbiAgICB0aGlzLl90ZXh0ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fbGlrZXNDb3VudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fdXNlciA9IHVzZXI7XG4gICAgdGhpcy5fdGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZSk7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24gPSBoYW5kbGVMaWtlQnV0dG9uO1xuICB9XG5cbiAgLy8gY2xvbmluZyBuZXcgY2FyZCBmcm9tIHRlbXBsYXRlIGFuZCBhZGRpbmcgdGhlIGluZm8gZnJvbSBpbnB1dFxuICBfZ2V0Q2FyZERhdGEoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSB0aGlzLl90ZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX2NhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIC8vIGNoZWNrIGlmIGNhcmQgaXMgbGlrZSB3aGVuIGNsaWNraW5nIG9uIHRoZSBsaWtlIGljb25cbiAgaXNDYXJkTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKHVzZXIpID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VyKTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0Q2FyZERhdGEoKTtcbiAgICB0aGlzLl9jYXJkUGhvdG8gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX3Bob3RvXCIpO1xuICAgIHRoaXMuX2NhcmRDYXB0aW9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3Rvcy1ncmlkX19sb2NhdGlvblwiKTtcbiAgICB0aGlzLl9saWtlc0NvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX2xpa2UtY291bnRlclwiKTtcbiAgICB0aGlzLl90cmFzaEljb24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX3RyYXNoXCIpO1xuICAgIHRoaXMuX2xpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzQ291bnQ7XG4gICAgdGhpcy5fY2FyZFBob3RvLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZFBob3RvLmFsdCA9IHRoaXMuX3RleHQ7XG4gICAgdGhpcy5fY2FyZENhcHRpb24udGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xuICAgIGlmICh0aGlzLl9vd25lciAhPT0gdGhpcy5fdXNlcikge1xuICAgICAgdGhpcy5fdHJhc2hJY29uLmNsYXNzTGlzdC5hZGQoXCJwaG90b3MtZ3JpZF9fdHJhc2hfZGlzYWJsZXNcIik7XG4gICAgfVxuICAgIGlmICh0aGlzLmlzQ2FyZExpa2VkKCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFydFwiKS5jbGFzc0xpc3QuYWRkKFwiaGVhcnRfYWN0aXZlXCIpO1xuICAgIH1cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgLy8gaGFuZGxlIGRlbGV0ZSBmdW5jdGlvblxuICBkZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgLy8gcmVtb3ZlIHRoZSBsaW5rIHRvIHRoZSBET00gZWxlbWVudDpcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIC8vIGFkZCBldmVudCBsaXN0ZW5lcnNcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFydFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUJ1dHRvbih0aGlzLl9pZCkpO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90b3MtZ3JpZF9fdHJhc2hcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5faWQpKTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX3Bob3RvXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xuICB9XG5cbiAgLy8gbWFyayBsaWtlIGljb24gYW5kIHVwZGF0ZSBsaWtlIGNvdW50ZXJcbiAgbGlrZUNhcmQgPSAoZGF0YSkgPT4ge1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhcnRcIikuY2xhc3NMaXN0LmFkZChcImhlYXJ0X2FjdGl2ZVwiKTtcbiAgICB0aGlzLl9saWtlc0NvdW50ZXIudGV4dENvbnRlbnQgPSBkYXRhLmxpa2VzLmxlbmd0aDtcbiAgfTtcblxuICAvLyByZW1vdmUgbGlrZSBpY29uIGFuZCB1cGRhdGUgbGlrZSBjb3VudGVyXG4gIHJlbW92ZUxpa2UgPSAoZGF0YSkgPT4ge1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhcnRcIikuY2xhc3NMaXN0LnJlbW92ZShcImhlYXJ0X2FjdGl2ZVwiKTtcbiAgICB0aGlzLl9saWtlc0NvdW50ZXIudGV4dENvbnRlbnQgPSBkYXRhLmxpa2VzLmxlbmd0aDtcbiAgfTtcbn1cbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGb3JtIHZhbGlkYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybSkge1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLl9mb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgLy8gc2V0dGluZyBhbiBhcnJheSBvZiBhbGwgaW5wdXQgZmllbGRzIG9mIGEgZ2l2ZW4gZm9ybVxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpXTtcblxuICAgIC8vIGRlY2xhcmluZyB0aGUgc3VibWl0IGJ1dHRvbiBvZiBhIGdpdmVuIGZvcm1cbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIC8vIGFkZCB0aGUgYWJpbGl0eSB0byByZXNldCB0aGUgdmFsaWRhdGlvbiBiZXR3ZWVuIHNlc3Npb25zXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cblxuICAvLyBwcm9tcHRpbmcgZXJyb3IgbWVzc2FnZSB3aXRoIGl0cyBzdHlsZSBwZXIgZm9ybSBhbmQgaW5wdXQgZmllbGRcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gIH1cblxuICAvLyByZW1vdmluZyB0aGUgZXJyb3IgbWVzc2FnZVxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICAvLyBjaGVja2luZyB0aGUgdmFsaWRpdHkgb2Ygc3BlY2lmaWMgaW5wdXRcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICAvLyBjaGVja2luZyB0aGUgdmFsaWRpdHkgb2YgZW50aXJlIGZvcm1cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICAvLyB0b2dnbGluZyB0aGUgc3VibWl0IGJ1dHRvbiBhY3RpdmUgb2YgaW5hY3RpdmUsIHRvIGJlIHVzZWQgYmFzZWQgb24gZm9ybSB2YWxpZGl0eVxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gYSBmdW5jdGlvbiB0byBhZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGV2ZXJ5IGZvciBpbnB1dCBmaWVsZCBpbiB0aGUgcGFnZVxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gc2V0dGluZyB0aGUgaW5pdGlhbCBzdGF0ZSBvZiB0aGUgc3VibWl0IGJ1dHRvbiAod2lsbCBiZSBzZXQgdG8gaW5hY3RpdmUpXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIC8vIHNldHRpbmcgZXZlbnQgbGlzdGVuZXIgZm9yIGV2ZXJ5IGlucHV0IGZpZWxkIHRvIHRlc3QgdmFsaWRpdHkgYW5kIHJlc3BvbmQgYWNjb3JkaW5nbHlcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlQ2xpY2tPdmVybGF5Q2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC50YXJnZXQgPT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xpY2tPdmVybGF5Q2xvc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgdGhpcy5fcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVDbGlja092ZXJsYXlDbG9zZSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XG4gICAgY29uc3QgaW5wdXRzID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIik7XG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSwgc3VibWl0QnV0dG9uKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cbiIsIi8vIGRlZmF1bHQgZm9ybSBzZWxlY3RvcnMgY29uZmlndXJhdGlvbiwgdG8gYmUgdXNlZCBieSBmb3JtLXZhbGlkYXRvclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc2F2ZS1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc2F2ZS1idXR0b25faW5hY3RpdmVcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF9zdGF0ZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBjdXN0b21GZXRjaCA9ICh1cmwsIGhlYWRlcnMsIGVycm9yRnVuY3Rpb24pID0+XG4gIGZldGNoKHVybCwgaGVhZGVycylcbiAgICAudGhlbigocmVzKSA9PiAocmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSkpXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICBlcnJvckZ1bmN0aW9uKGVycik7XG4gICAgfSk7XG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGluZyBlbGVtZW50cyBhbmQgY2xhc3NlcyAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgcHJvZmlsZUF2YXRhckVkaXRTb3VyY2UgZnJvbSBcIi4uL2ltYWdlcy9lZGl0X2ljb24uc3ZnXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoTWVzc2FnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhNZXNzYWdlLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgeyBmb3JtQ29uZmlnLCBjdXN0b21GZXRjaCB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAgZm9yIGVycm9yIG1lc3NhZ2VcbmNvbnN0IHBvcHVwRXJyb3JTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfZXJyb3JcIjtcbmNvbnN0IHBvcHVwRXJyb3IgPSBuZXcgUG9wdXBXaXRoTWVzc2FnZShwb3B1cEVycm9yU2VsZWN0b3IpO1xucG9wdXBFcnJvci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBzZXR0aW5nIHVwIHRoZSBBUEkgZm9yIGN1cnJlbnQgdXNlclxuY29uc3QgYXBpID0gbmV3IEFwaShjdXN0b21GZXRjaCwge1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiM2U2M2IxN2EtNjQ5Ny00MjI2LTkwY2YtNGQ3OTM3YjdhYmExXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG4gIGVycm9yRnVuY3Rpb246IChlcnJNZXNzYWdlKSA9PiB7XG4gICAgcG9wdXBFcnJvci5nZXRNZXNzYWdlKFwiLnBvcHVwX190ZXh0XCIsIGVyck1lc3NhZ2UpO1xuICAgIHBvcHVwRXJyb3Iub3BlbigpO1xuICB9LFxufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9maWxlIHNlY3Rpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLy8gc2V0dGluZyB1cCB0aGUgaW5pdGlhbCBwcm9maWxlIGluZm9cbmNvbnN0IHByb2ZpbGVOYW1lU2VsZWN0b3IgPSBcIi5wcm9maWxlX19uYW1lXCI7XG5jb25zdCBwcm9maWxlVGl0bGVTZWxlY3RvciA9IFwiLnByb2ZpbGVfX3RpdGxlXCI7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlLWF2YXRhclwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJFZGl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlLWF2YXRhci1lZGl0XCIpO1xucHJvZmlsZUF2YXRhckVkaXQuc3JjID0gcHJvZmlsZUF2YXRhckVkaXRTb3VyY2U7XG5jb25zdCBuYW1lSW5wdXQgPSBcIi5wb3B1cF9faW5wdXRfdHlwZV9uYW1lXCI7XG5jb25zdCBqb2JJbnB1dCA9IFwiLnBvcHVwX19pbnB1dF90eXBlX2pvYlwiO1xuY29uc3QgdXNlclByb2ZpbGUgPSBuZXcgVXNlckluZm8ocHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZVRpdGxlU2VsZWN0b3IsIG5hbWVJbnB1dCwgam9iSW5wdXQpO1xubGV0IHVzZXJJZDtcblxuLy8gbG9hZGluZyB0aGUgcGFnZSBhdCBvbmNlOiBzZXR0aW5nIHVwIHByb2ZpbGUgaW5mbyBmcm9tIHRoZSBzZXJ2ZXIgYW5kIHJlbmRlcmluZyB0aGUgaW5pdGlhbCBjYXJkc1xuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKS50aGVuKChbdXNlckluZm8sIGluaXRpYWxDYXJkc10pID0+IHtcbiAgLy8gc2V0dGluZyB1cCBwcm9maWxlIGluZm8gZnJvbSB0aGUgc2VydmVyXG4gIHVzZXJJZCA9IHVzZXJJbmZvLl9pZDtcbiAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgbmFtZTogdXNlckluZm8ubmFtZSxcbiAgICBhYm91dDogdXNlckluZm8uYWJvdXQsXG4gIH07XG4gIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgcHJvZmlsZUF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dXNlckluZm8uYXZhdGFyfSlgO1xuXG4gIC8vIHJlbmRlcmluZyB0aGUgaW5pdGlhbCBjYXJkc1xuICBjYXJkc0xpc3QucmVuZGVyZXIoaW5pdGlhbENhcmRzKTtcbn0pO1xuXG4vLyBzZXR0aW5nIHVwIHRoZSBwb3B1cC1mb3JtIGZvciBlZGl0aW5nIHRoZSBwcm9maWxlXG5jb25zdCBwb3B1cEVkaXRQcm9maWxlID0gXCIucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGVcIjtcbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBFZGl0UHJvZmlsZSwgKGZvcm1WYWx1ZXMsIHN1Ym1pdEJ1dHRvbikgPT4ge1xuICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBhcGlcbiAgICAudXBkYXRlVXNlckluZm8oZm9ybVZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB1c2VyUHJvZmlsZS5zZXRVc2VySW5mbyhyZXMpKVxuICAgIC50aGVuKHBvcHVwRWRpdFByb2ZpbGVGb3JtLmNsb3NlKCkpXG4gICAgLnRoZW4oKHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiKSk7XG59KTtcbnBvcHVwRWRpdFByb2ZpbGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIGhhbmRsZSBlZGl0LXByb2ZpbGUgZm9ybSBtb2RhbCBvcGVuXG5jb25zdCBvcGVuRWRpdFByb2ZpbGVGb3JtID0gKCkgPT4ge1xuICBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKHVzZXJQcm9maWxlLmdldFVzZXJJbmZvKCkpO1xuICBwb3B1cEVkaXRQcm9maWxlRm9ybS5vcGVuKCk7XG59O1xuXG4vLyBlbmFibGluZyB2YWxpZGF0aW9uIGZvciBlZGl0LXByb2ZpbGUgZm9ybVxuY29uc3QgZm9ybUVkaXRQcm9maWxlID0gXCIucG9wdXBfX2Zvcm1fdHlwZV9lZGl0LXByb2ZpbGVcIjtcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1FZGl0UHJvZmlsZSk7XG5lZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBldmVudCBsaXN0ZW5lcnMgZm9yIHByb21wdGluZyBwcm9maWxlLWVkaXQgcG9wdXAgd2hlbiBjbGlja2luZyB0aGUgZWRpdCBpY29uXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0UHJvZmlsZUZvcm0pO1xuXG4vLyBzZXR0aW5nIHVwIHRoZSBwb3B1cC1mb3JtIGZvciBlZGl0aW5nIHRoZSBhdmF0YXJcbmNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IFwiLnBvcHVwX3R5cGVfZWRpdC1hdmF0YXJcIjtcbmNvbnN0IHBvcHVwRWRpdEF2YXRhckZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEVkaXRBdmF0YXIsIChmb3JtVmFsdWVzLCBzdWJtaXRCdXR0b24pID0+IHtcbiAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgYXBpXG4gICAgLnNldFVzZXJBdmF0YXIoZm9ybVZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBwcm9maWxlQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHtyZXMuYXZhdGFyfSlgO1xuICAgIH0pXG4gICAgLnRoZW4ocG9wdXBFZGl0QXZhdGFyRm9ybS5jbG9zZSgpKVxuICAgIC50aGVuKChzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIikpO1xufSk7XG5wb3B1cEVkaXRBdmF0YXJGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIGhhbmRsZSBlZGl0LWF2YXRhciBmb3JtIG1vZGFsIG9wZW5cbmNvbnN0IG9wZW5FZGl0QXZhdGFyRm9ybSA9ICgpID0+IHtcbiAgZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwRWRpdEF2YXRhckZvcm0ub3BlbigpO1xufTtcblxuLy8gZW5hYmxpbmcgdmFsaWRhdGlvbiBmb3IgZWRpdC1hdmF0YXIgZm9ybVxuY29uc3QgZm9ybUVkaXRBdmF0YXIgPSBcIi5wb3B1cF9fZm9ybV90eXBlX2VkaXQtYXZhdGFyXCI7XG5jb25zdCBlZGl0QXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1FZGl0QXZhdGFyKTtcbmVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gZXZlbnQgbGlzdGVuZXJzIGZvciBwcm9tcHRpbmcgYXZhdGFyLWVkaXQgcG9wdXAgd2hlbiBjbGlja2luZyB0aGUgZWRpdCBpY29uXG5jb25zdCBhdmF0YXJFZGl0QXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWNvdmVyXCIpO1xuYXZhdGFyRWRpdEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0QXZhdGFyRm9ybSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHMgc2VjdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLy8gc2V0dGluZyB1cCB0aGUgaW5pdGlhbCBpbWFnZSBwb3B1cFxuY29uc3QgcG9wdXBDYXJkID0gXCIucGljdHVyZS1wb3B1cFwiO1xuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cENhcmQsIFwiIFwiLCBcIiBcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIHNldHRpbmcgdXAgdGhlIGluaXRpYWwgZGVsZXRlLWNhcmQgcG9wdXBcbmNvbnN0IHBvcHVwRGVsZXRlQ2FyZFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9kZWxldGUtY2FyZFwiO1xuY29uc3QgcG9wdXBEZWxldGVDYXJkID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihwb3B1cERlbGV0ZUNhcmRTZWxlY3Rvcik7XG5wb3B1cERlbGV0ZUNhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gZnVuY3Rpb24gdG8gcmVuZGVyIGEgbmV3IGNhcmQgZnJvbSBnaXZlbiBkYXRhXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmRJdGVtKSA9PiB7XG4gIGNvbnN0IHBsYWNlQ2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmRJdGVtLFxuICAgIHVzZXJJZCxcbiAgICBcImNhcmQtdGVtcGxhdGVcIixcbiAgICAvLyBmdW5jdGlvbiB0byBiZSBwZXJmb3JtZWQgd2hlbiBjbGlja2luZyBvbiB0aGUgbmV3IGNhcmQ6XG4gICAgKCkgPT4ge1xuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGNhcmRJdGVtKTtcbiAgICB9LFxuICAgIC8vIGZ1bmN0aW9uIHRvIGJlIHBlcmZvcm1lZCB3aGVuIGNsaWNraW5nIG9uIHRoZSBiaW4gaWNvbiBvZiB0aGUgbmV3IGNhcmQ6XG4gICAgKGNhcmRJZCkgPT4ge1xuICAgICAgcG9wdXBEZWxldGVDYXJkLm9wZW4oKTtcbiAgICAgIC8vIGZ1bmN0aW9uIHRvIGJlIHBlcmZvcm1lZCB3aGVuIGFwcHJvdmluZyB0aGUgcG9wdXAgZm9yIGRlbGV0aW5nIHRoZSBuZXcgY2FyZDpcbiAgICAgIHBvcHVwRGVsZXRlQ2FyZC5nZXRUYXNrKCgpID0+IHtcbiAgICAgICAgYXBpLmRlbGV0ZUNhcmQoY2FyZElkKTtcbiAgICAgICAgcGxhY2VDYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgLy8gZnVuY3Rpb24gdG8gYmUgcGVyZm9ybWVkIHdoZW4gY2xpY2tpbmcgb24gdGhlIGxpa2UgaWNvbiBvZiB0aGUgbmV3IGNhcmQ6XG4gICAgKGNhcmRJZCkgPT4ge1xuICAgICAgY29uc3QgaXNMaWtlZCA9IHBsYWNlQ2FyZC5pc0NhcmRMaWtlZCgpO1xuICAgICAgaWYgKGlzTGlrZWQpIHtcbiAgICAgICAgYXBpLnJlbW92ZUxpa2UoY2FyZElkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBwbGFjZUNhcmQucmVtb3ZlTGlrZShyZXMpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFwaS5hZGRMaWtlKGNhcmRJZCkudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgcGxhY2VDYXJkLmxpa2VDYXJkKHJlcyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgY29uc3QgcGxhY2VDYXJkRWxlbWVudCA9IHBsYWNlQ2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgY2FyZHNMaXN0LmFkZEl0ZW0ocGxhY2VDYXJkRWxlbWVudCk7XG59O1xuXG4vLyBzZXR0aW5nIHVwIHRoZSBjYXJkcyBsaXN0IHNlY3Rpb25cbmNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKHJlbmRlckNhcmQsIFwiLnBob3Rvcy1ncmlkX19saXN0XCIpO1xuXG4vLyBzZXR0aW5nIHVwIHRoZSBwb3B1cC1mb3JtIGZvciByZW5kZXJpbmcgbmV3IGNhcmRzXG5jb25zdCBwb3B1cEFkZENhcmQgPSBcIi5wb3B1cF90eXBlX2FkZC1jYXJkXCI7XG5jb25zdCBwb3B1cEFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBBZGRDYXJkLCAoZm9ybVZhbHVlcywgc3VibWl0QnV0dG9uKSA9PiB7XG4gIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ3JlYXRpbmcuLi5cIjtcbiAgYXBpXG4gICAgLnNldE5ld0NhcmQoZm9ybVZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKHJlcyk7XG4gICAgfSlcbiAgICAudGhlbihwb3B1cEFkZENhcmRGb3JtLmNsb3NlKCkpXG4gICAgLnRoZW4oKHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ3JlYXRlXCIpKTtcbn0pO1xucG9wdXBBZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBoYW5kbGUgYWRkLWNhcmQgZm9ybSBtb2RhbCBvcGVuXG5jb25zdCBvcGVuQWRkQ2FyZEZvcm0gPSAoKSA9PiB7XG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBwb3B1cEFkZENhcmRGb3JtLm9wZW4oKTtcbn07XG5cbi8vIGV2ZW50IGxpc3RlbmVycyBmb3IgcHJvbXB0aW5nIGFkZC1jYXJkIHBvcHVwIHdoZW4gY2xpY2tpbmcgdGhlIGFkZCBpY29uXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlbkFkZENhcmRGb3JtKTtcblxuLy8gZW5hYmxpbmcgdmFsaWRhdGlvbiBmb3IgYWRkLWNhcmQgZm9ybVxuY29uc3QgZm9ybUFkZENhcmQgPSBcIi5wb3B1cF9fZm9ybV90eXBlX2FkZC1jYXJkXCI7XG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1BZGRDYXJkKTtcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoTWVzc2FnZSBleHRlbmRzIFBvcHVwIHtcbiAgZ2V0TWVzc2FnZShtZXNzYWdlRmllbGQsIG1lc3NhZ2UpIHtcbiAgICB0aGlzLl9tZXNzYWdlRmllbGQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKG1lc3NhZ2VGaWVsZCk7XG4gICAgdGhpcy5fbWVzc2FnZUZpZWxkLnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoY3VzdG9tRmV0Y2gsIHsgYmFzZVVybCwgaGVhZGVycywgZXJyb3JGdW5jdGlvbiB9KSB7XG4gICAgdGhpcy5fY3VzdG9tRmV0Y2ggPSBjdXN0b21GZXRjaDtcbiAgICB0aGlzLl9lcnJvckZ1bmN0aW9uID0gZXJyb3JGdW5jdGlvbjtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goXG4gICAgICBgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsXG4gICAgICB7XG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9LFxuICAgICAgdGhpcy5fZXJyb3JGdW5jdGlvblxuICAgICk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goXG4gICAgICBgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsXG4gICAgICB7XG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9LFxuICAgICAgdGhpcy5fZXJyb3JGdW5jdGlvblxuICAgICk7XG4gIH1cblxuICB1cGRhdGVVc2VySW5mbyh1c2VyRGF0YSkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChcbiAgICAgIGAke3RoaXMuX2Jhc2VVcmx9L3VzcnMvbWVgLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxuXG4gIHNldE5ld0NhcmQoY2FyZERhdGEpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goXG4gICAgICBgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBuYW1lOiBjYXJkRGF0YS5uYW1lLFxuICAgICAgICAgIGxpbms6IGNhcmREYXRhLmxpbmssXG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICAgIHRoaXMuX2Vycm9yRnVuY3Rpb25cbiAgICApO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goXG4gICAgICBgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9LFxuICAgICAgdGhpcy5fZXJyb3JGdW5jdGlvblxuICAgICk7XG4gIH1cblxuICBhZGRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChcbiAgICAgIGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKFxuICAgICAgYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgfSxcbiAgICAgIHRoaXMuX2Vycm9yRnVuY3Rpb25cbiAgICApO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXJMaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKFxuICAgICAgYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBhdmF0YXI6IGF2YXRhckxpbmsuYXZhdGFyLFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZVNlbGVjdG9yLCB1c2VySm9iU2VsZWN0b3IsIGZvcm1OYW1lSW5wdXQsIGZvcm1Kb2JJbnB1dCkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySm9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1OYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm1OYW1lSW5wdXQpO1xuICAgIHRoaXMuX2Zvcm1Kb2JJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybUpvYklucHV0KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHVzZXJEYXRhID0ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICAgIHJldHVybiB1c2VyRGF0YTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5ld1VzZXJEYXRhKSB7XG4gICAgdGhpcy5fZm9ybU5hbWVJbnB1dC52YWx1ZSA9IG5ld1VzZXJEYXRhLm5hbWU7XG4gICAgdGhpcy5fZm9ybUpvYklucHV0LnZhbHVlID0gbmV3VXNlckRhdGEuYWJvdXQ7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuZXdVc2VyRGF0YS5uYW1lO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBuZXdVc2VyRGF0YS5hYm91dDtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc291cmNlLCBjYXB0aW9uKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fc291cmNlID0gc291cmNlO1xuICAgIHRoaXMuX2NhcHRpb24gPSBjYXB0aW9uO1xuICB9XG4gIG9wZW4obmV3UG9wdXBJbWFnZSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9zb3VyY2UgPSBuZXdQb3B1cEltYWdlLmxpbms7XG4gICAgdGhpcy5fY2FwdGlvbiA9IG5ld1BvcHVwSW1hZ2UubmFtZTtcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5waWN0dXJlLXBvcHVwX19wb3B1cC1pbWFnZVwiKTtcbiAgICB0aGlzLl9wb3B1cENhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBpY3R1cmUtcG9wdXBfX3BvcHVwLXRleHRcIik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSB0aGlzLl9zb3VyY2U7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSB0aGlzLl9jYXB0aW9uO1xuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuX2NhcHRpb247XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBnZXRUYXNrKHRhc2spIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gdGFzaztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHJlbmRlckl0ZW0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVySXRlbSA9IHJlbmRlckl0ZW07XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cbiAgcmVuZGVyZXIoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJJdGVtKGl0ZW0pO1xuICAgIH0pO1xuICB9XG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJwIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXIiLCJ0ZW1wbGF0ZSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlQnV0dG9uIiwidGhpcyIsIl9saWtlcyIsImxpa2VzIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2xpa2VzQ291bnRlciIsInRleHRDb250ZW50IiwibGVuZ3RoIiwicmVtb3ZlIiwiX3RleHQiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2xpa2VzQ291bnQiLCJfb3duZXIiLCJvd25lciIsIl91c2VyIiwiX3RlbXBsYXRlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2dldENhcmREYXRhIiwiY29udGVudCIsImNsb25lTm9kZSIsImlzQ2FyZExpa2VkIiwic29tZSIsImdlbmVyYXRlQ2FyZCIsIl9jYXJkUGhvdG8iLCJfY2FyZENhcHRpb24iLCJfdHJhc2hJY29uIiwic3JjIiwiYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZGVsZXRlQ2FyZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybSIsIl9jb25maWciLCJfZm9ybSIsImVuYWJsZVZhbGlkYXRpb24iLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwicmVzZXQiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsIl9wb3B1cCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjbG9zZSIsIm9wZW4iLCJfaGFuZGxlQ2xpY2tPdmVybGF5Q2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsIl9wb3B1cEZvcm0iLCJzdWJtaXRCdXR0b24iLCJmb3JtQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwicG9wdXBFcnJvciIsImdldE1lc3NhZ2UiLCJtZXNzYWdlRmllbGQiLCJtZXNzYWdlIiwiX21lc3NhZ2VGaWVsZCIsImFwaSIsImN1c3RvbUZldGNoIiwiYmFzZVVybCIsImhlYWRlcnMiLCJlcnJvckZ1bmN0aW9uIiwiX2N1c3RvbUZldGNoIiwiX2Vycm9yRnVuY3Rpb24iLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJ1cGRhdGVVc2VySW5mbyIsInVzZXJEYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInNldE5ld0NhcmQiLCJjYXJkRGF0YSIsImNhcmRJZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwic2V0VXNlckF2YXRhciIsImF2YXRhckxpbmsiLCJhdmF0YXIiLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImF1dGhvcml6YXRpb24iLCJlcnJNZXNzYWdlIiwicHJvZmlsZUF2YXRhciIsInByb2ZpbGVBdmF0YXJFZGl0U291cmNlIiwidXNlclByb2ZpbGUiLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlckpvYlNlbGVjdG9yIiwiZm9ybU5hbWVJbnB1dCIsImZvcm1Kb2JJbnB1dCIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2Zvcm1OYW1lSW5wdXQiLCJfZm9ybUpvYklucHV0Iiwic2V0VXNlckluZm8iLCJuZXdVc2VyRGF0YSIsInVzZXJJZCIsImFsbCIsInVzZXJJbmZvIiwiaW5pdGlhbENhcmRzIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJjYXJkc0xpc3QiLCJyZW5kZXJlciIsInBvcHVwRWRpdFByb2ZpbGVGb3JtIiwiZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yIiwicG9wdXBFZGl0QXZhdGFyRm9ybSIsImVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yIiwiaW1hZ2VQb3B1cCIsInNvdXJjZSIsImNhcHRpb24iLCJfc291cmNlIiwiX2NhcHRpb24iLCJuZXdQb3B1cEltYWdlIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwicG9wdXBEZWxldGVDYXJkIiwiZ2V0VGFzayIsInRhc2siLCJyZW5kZXJDYXJkIiwiY2FyZEl0ZW0iLCJwbGFjZUNhcmQiLCJsaWtlQ2FyZCIsInBsYWNlQ2FyZEVsZW1lbnQiLCJhZGRJdGVtIiwicmVuZGVySXRlbSIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlckl0ZW0iLCJfY29udGFpbmVyIiwiaXRlbXMiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJwb3B1cEFkZENhcmRGb3JtIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9