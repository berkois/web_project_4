!function(){"use strict";var t={717:function(t,e,s){t.exports=s.p+"a086f758840ae814ecde.svg"}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}s.p="",function(){var t=s(717);class e{constructor(t,e,s,i,r,n){var o,a;a=t=>{this._likes=t.likes,this._likeButton.classList.toggle("heart_active"),this._likesCounter.textContent=t.likes.length},(o="updateLikes")in this?Object.defineProperty(this,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[o]=a,this._text=t.name,this._link=t.link,this._id=t._id,this._likes=t.likes,this._likesCount=t.likes.length,this._owner=t.owner._id,this._user=e,this._template=document.getElementById(s),this._handleCardClick=i,this._handleDeleteCard=r,this._handleLikeButton=n}_getCardData(){return this._template.content.querySelector(".photos-grid__card").cloneNode(!0)}isCardLiked(){return this._likes.some((t=>t._id===this._user))}generateCard(){return this._element=this._getCardData(),this._cardPhoto=this._element.querySelector(".photos-grid__photo"),this._cardCaption=this._element.querySelector(".photos-grid__location"),this._likesCounter=this._element.querySelector(".photos-grid__like-counter"),this._trashIcon=this._element.querySelector(".photos-grid__trash"),this._likeButton=this._element.querySelector(".heart"),this._likesCounter.textContent=this._likesCount,this._cardPhoto.src=this._link,this._cardPhoto.alt=this._text,this._cardCaption.textContent=this._text,this._owner!==this._user&&this._trashIcon.classList.add("photos-grid__trash_disables"),this.isCardLiked()&&this._likeButton.classList.add("heart_active"),this._setEventListeners(),this._element}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._trashIcon.addEventListener("click",(()=>this._handleDeleteCard(this._id))),this._cardPhoto.addEventListener("click",this._handleCardClick)}deleteCardElement(){this._element.remove(),this._element=null}}class i{constructor(t,e){this._config=t,this._form=document.querySelector(e)}enableValidation(){this._inputList=[...this._form.querySelectorAll(this._config.inputSelector)],this._buttonElement=this._form.querySelector(this._config.submitButtonSelector),this._form.addEventListener("submit",(function(t){t.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}_showInputError(t){const e=this._form.querySelector(".".concat(t.id,"-error"));t.classList.add(this._config.inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._config.errorClass)}_hideInputError(t){const e=this._form.querySelector(".".concat(t.id,"-error"));t.classList.remove(this._config.inputErrorClass),e.classList.remove(this._config.errorClass),e.textContent=""}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}}function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class n{constructor(t){r(this,"_handleEscClose",(t=>{"Escape"===t.key&&this._popup.classList.remove("popup_opened")})),r(this,"_handleClickOverlayClose",(t=>{t.target==t.currentTarget&&this.close()})),this._popup=document.querySelector(t)}open(){this._popup.classList.add("popup_opened"),this._popup.addEventListener("mousedown",this._handleClickOverlayClose),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),this._popup.removeEventListener("mousedown",this._handleClickOverlayClose),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.querySelector(".popup__close-button").addEventListener("click",(()=>this.close()))}}class o extends n{constructor(t,e,s){var i,r;super(t),r=t=>{t.preventDefault(),this._renderLoading(),this._actionsForSubmit(this._getInputValues(),this._button)},(i="_handleFormSubmit")in this?Object.defineProperty(this,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[i]=r,this._inputs=this._popup.querySelectorAll(e.inputSelector),this._button=this._popup.querySelector(e.submitButtonSelector),this._actionsForSubmit=s}_getInputValues(){const t={};return this._inputs.forEach((e=>{t[e.name]=e.value})),t}_renderLoading(){this._button.textContent="Saving..."}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",this._handleFormSubmit)}close(){this._popupForm.reset(),super.close()}}const a={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_inactive",inputErrorClass:"popup__input_state_error",errorClass:"popup__input-error_active"},h=document.querySelector(".popup__input_type_name"),c=document.querySelector(".popup__input_type_job"),l=document.getElementById("edit-avatar-icon"),_=document.querySelector(".profile__edit-button"),p=document.querySelector(".profile__avatar-cover"),u=document.querySelector(".profile__add-button"),d=new class extends n{getMessage(t,e){this._messageField=this._popup.querySelector(t),this._messageField.textContent=e}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this.close()}))}}(".popup_type_error");d.setEventListeners();const m=t=>{console.log("error: ".concat(t)),d.getMessage(".popup__text","error: ".concat(t)),d.open()},v=new class{constructor(t,e){let{baseUrl:s,headers:i}=e;var r,n;n=t=>this._customFetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this._headers}),(r="deleteCard")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this._customFetch=t,this._baseUrl=s,this._headers=i}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}updateUserInfo(t){return this._customFetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t.name,about:t.about})})}setNewCard(t){return this._customFetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t.name,link:t.link})})}addLike(t){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:this._headers})}removeLike(t){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:this._headers})}setUserAvatar(t){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t.avatar})})}}(((t,e)=>fetch(t,e).then((t=>t.ok?t.json():Promise.reject(t.status)))),{baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"3e63b17a-6497-4226-90cf-4d7937b7aba1","Content-Type":"application/json"}});l.src=t;const b=new class{constructor(t,e,s){this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(e),this._avatarElement=document.querySelector(s)}getUserData(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserData(t){this._nameElement.textContent=t.name,this._jobElement.textContent=t.about}setUserAvatar(t){this._avatarElement.style.backgroundImage="url(".concat(t,")")}}(".profile__name",".profile__title",".profile__avatar");let E;Promise.all([v.getUserInfo(),v.getInitialCards()]).then((t=>{let[e,s]=t;E=e._id,b.setUserData(e),b.setUserAvatar(e.avatar),I.renderer(s)})).catch((t=>m(t)));const f=new o(".popup_type_edit-profile",a,(function(t,e){v.updateUserInfo(t).then((t=>{b.setUserData(t)})).then((()=>f.close())).catch((t=>m(t))).finally((()=>e.textContent="Save"))}));f.setEventListeners();const g=new i(a,".popup__form_type_edit-profile");g.enableValidation(),_.addEventListener("click",(()=>{g.resetValidation();const t=b.getUserData();h.value=t.name,c.value=t.about,f.open()}));const y=new o(".popup_type_edit-avatar",a,(function(t,e){v.setUserAvatar(t).then((t=>{b.setUserAvatar(t.avatar)})).then((()=>y.close())).catch((t=>m(t))).finally((()=>e.textContent="Save"))}));y.setEventListeners();const C=new i(a,".popup__form_type_edit-avatar");C.enableValidation(),p.addEventListener("click",(()=>{C.resetValidation(),y.open()}));const L=new class extends n{constructor(t,e,s){super(t),this._source=e,this._caption=s,this._popupImage=this._popup.querySelector(".picture-popup__popup-image"),this._popupCaption=this._popup.querySelector(".picture-popup__popup-text")}open(t){super.open(),this._source=t.link,this._caption=t.name,this._popupImage.src=this._source,this._popupImage.alt=this._caption,this._popupCaption.textContent=this._caption}}(".picture-popup"," "," ");L.setEventListeners();const k=new class extends n{setSubmitHandler(t){this._handleFormSubmit=t}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit()}))}}(".popup_type_delete-card");k.setEventListeners();const S=t=>{const s=new e(t,E,"card-template",(()=>{L.open(t)}),(t=>{k.open(),k.setSubmitHandler((()=>{v.deleteCard(t).then((()=>s.deleteCardElement())).then((()=>k.close())).catch((t=>m(t)))}))}),(t=>{s.isCardLiked()?v.removeLike(t).then((t=>{s.updateLikes(t)})).catch((t=>m(t))):v.addLike(t).then((t=>{s.updateLikes(t)})).catch((t=>m(t)))})),i=s.generateCard();I.addItem(i)},I=new class{constructor(t,e){this._renderItem=t,this._container=document.querySelector(e)}renderer(t){t.forEach((t=>{this._renderItem(t)}))}addItem(t){this._container.prepend(t)}}(S,".photos-grid__list"),q=new o(".popup_type_add-card",a,(function(t,e){v.setNewCard(t).then((t=>{S(t)})).then((()=>q.close())).catch((t=>m(t))).finally((()=>e.textContent="Create"))}));q.setEventListeners(),u.addEventListener("click",(()=>{x.resetValidation(),q.open()}));const x=new i(a,".popup__form_type_add-card");x.enableValidation()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFFdkIyQixPQUFPekQsR0FBUUQsRUFBY0MsUUFJaENnRixFQUFtQkgsRUFBVS9KLGVBQ25DeUksRUFBVTBCLFFBQVFELElBSWR6QixFQUFZLElNbkxILE1BQ2I5SyxZQUFZeU0sRUFBWUMsR0FDdEJuTSxLQUFLb00sWUFBY0YsRUFDbkJsTSxLQUFLcU0sV0FBYWxMLFNBQVNPLGNBQWN5SyxHQUUzQzNCLFNBQVM4QixHQUNQQSxFQUFNN0ksU0FBUzhJLElBQ2J2TSxLQUFLb00sWUFBWUcsTUFHckJOLFFBQVFPLEdBQ054TSxLQUFLcU0sV0FBV0ksUUFBUUQsS053S0ViLEVBQVksc0JBR3BDZSxFQUFtQixJQUFJdEgsRUQxSkQsdUJDMEo2QmMsR0FJekQsU0FBaUNOLEVBQVkrRSxHQUMzQ3hELEVBQ0dpQixXQUFXeEMsR0FDWGlELE1BQU1DLElBQ0w2QyxFQUFXN0MsTUFFWkQsTUFBSyxJQUFNNkQsRUFBaUI1SCxVQUM1QjJGLE9BQU96RCxHQUFRRCxFQUFjQyxLQUM3QjRELFNBQVEsSUFBT0QsRUFBYXBLLFlBQWMsY0FYL0NtTSxFQUFpQnZILG9CQXFCakJzQixFQUFjbEUsaUJBQWlCLFNBTlAsS0FDdEJvSyxFQUFxQnBKLGtCQUNyQm1KLEVBQWlCM0gsVUFPbkIsTUFBTTRILEVBQXVCLElBQUlqSyxFQUFjd0QsRURqTHBCLDhCQ2tMM0J5RyxFQUFxQjVKLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhNZXNzYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJkIEdlbmVyYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHVzZXIsIHRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNhcmQsIGhhbmRsZUxpa2VCdXR0b24pIHtcbiAgICB0aGlzLl90ZXh0ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fbGlrZXNDb3VudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fdXNlciA9IHVzZXI7XG4gICAgdGhpcy5fdGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZSk7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24gPSBoYW5kbGVMaWtlQnV0dG9uO1xuICB9XG5cbiAgLy8gY2xvbmluZyBuZXcgY2FyZCBmcm9tIHRlbXBsYXRlIGFuZCBhZGRpbmcgdGhlIGluZm8gZnJvbSBpbnB1dFxuICBfZ2V0Q2FyZERhdGEoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSB0aGlzLl90ZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX2NhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIC8vIGNoZWNrIGlmIGNhcmQgaXMgbGlrZSB3aGVuIGNsaWNraW5nIG9uIHRoZSBsaWtlIGljb25cbiAgaXNDYXJkTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKHVzZXIpID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VyKTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0Q2FyZERhdGEoKTtcbiAgICB0aGlzLl9jYXJkUGhvdG8gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX3Bob3RvXCIpO1xuICAgIHRoaXMuX2NhcmRDYXB0aW9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3Rvcy1ncmlkX19sb2NhdGlvblwiKTtcbiAgICB0aGlzLl9saWtlc0NvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX2xpa2UtY291bnRlclwiKTtcbiAgICB0aGlzLl90cmFzaEljb24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX3RyYXNoXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhcnRcIik7XG4gICAgdGhpcy5fbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNDb3VudDtcbiAgICB0aGlzLl9jYXJkUGhvdG8uc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkUGhvdG8uYWx0ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9jYXJkQ2FwdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XG4gICAgaWYgKHRoaXMuX293bmVyICE9PSB0aGlzLl91c2VyKSB7XG4gICAgICB0aGlzLl90cmFzaEljb24uY2xhc3NMaXN0LmFkZChcInBob3Rvcy1ncmlkX190cmFzaF9kaXNhYmxlc1wiKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNDYXJkTGlrZWQoKSkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiaGVhcnRfYWN0aXZlXCIpO1xuICAgIH1cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgLy8gYWRkIGV2ZW50IGxpc3RlbmVyc1xuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUJ1dHRvbih0aGlzLl9pZCkpO1xuICAgIHRoaXMuX3RyYXNoSWNvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZCkpO1xuICAgIHRoaXMuX2NhcmRQaG90by5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcbiAgfVxuXG4gIC8vIGhhbmRsZSBkZWxldGUgZnVuY3Rpb25cbiAgZGVsZXRlQ2FyZEVsZW1lbnQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAvLyByZW1vdmUgdGhlIGxpbmsgdG8gdGhlIERPTSBlbGVtZW50OlxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgLy8gbWFyayBsaWtlIGljb24gYW5kIHVwZGF0ZSBsaWtlIGNvdW50ZXJcbiAgdXBkYXRlTGlrZXMgPSAoZGF0YSkgPT4ge1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJoZWFydF9hY3RpdmVcIik7XG4gICAgdGhpcy5fbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XG4gIH07XG59XG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9ybSB2YWxpZGF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm0pIHtcbiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5fZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIC8vIHNldHRpbmcgYW4gYXJyYXkgb2YgYWxsIGlucHV0IGZpZWxkcyBvZiBhIGdpdmVuIGZvcm1cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2NvbmZpZy5pbnB1dFNlbGVjdG9yKV07XG5cbiAgICAvLyBkZWNsYXJpbmcgdGhlIHN1Ym1pdCBidXR0b24gb2YgYSBnaXZlbiBmb3JtXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICAvLyBhZGQgdGhlIGFiaWxpdHkgdG8gcmVzZXQgdGhlIHZhbGlkYXRpb24gYmV0d2VlbiBzZXNzaW9uc1xuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gcHJvbXB0aW5nIGVycm9yIG1lc3NhZ2Ugd2l0aCBpdHMgc3R5bGUgcGVyIGZvcm0gYW5kIGlucHV0IGZpZWxkXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgLy8gcmVtb3ZpbmcgdGhlIGVycm9yIG1lc3NhZ2VcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgLy8gY2hlY2tpbmcgdGhlIHZhbGlkaXR5IG9mIHNwZWNpZmljIGlucHV0XG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgLy8gY2hlY2tpbmcgdGhlIHZhbGlkaXR5IG9mIGVudGlyZSBmb3JtXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgLy8gdG9nZ2xpbmcgdGhlIHN1Ym1pdCBidXR0b24gYWN0aXZlIG9mIGluYWN0aXZlLCB0byBiZSB1c2VkIGJhc2VkIG9uIGZvcm0gdmFsaWRpdHlcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8vIGEgZnVuY3Rpb24gdG8gYWRkIGV2ZW50IGxpc3RlbmVyIGZvciBldmVyeSBmb3IgaW5wdXQgZmllbGQgaW4gdGhlIHBhZ2VcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIHNldHRpbmcgdGhlIGluaXRpYWwgc3RhdGUgb2YgdGhlIHN1Ym1pdCBidXR0b24gKHdpbGwgYmUgc2V0IHRvIGluYWN0aXZlKVxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICAvLyBzZXR0aW5nIGV2ZW50IGxpc3RlbmVyIGZvciBldmVyeSBpbnB1dCBmaWVsZCB0byB0ZXN0IHZhbGlkaXR5IGFuZCByZXNwb25kIGFjY29yZGluZ2x5XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICB9XG4gIH07XG5cbiAgX2hhbmRsZUNsaWNrT3ZlcmxheUNsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0ID09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUNsaWNrT3ZlcmxheUNsb3NlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIHRoaXMuX3BvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xpY2tPdmVybGF5Q2xvc2UpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBjb25maWcsIGFjdGlvbnNGb3JTdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKTtcbiAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5fYWN0aW9uc0ZvclN1Ym1pdCA9IGFjdGlvbnNGb3JTdWJtaXQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBmb3JtVmFsdWVzO1xuICB9XG5cbiAgX3JlbmRlckxvYWRpbmcoKSB7XG4gICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgfVxuXG4gIF9oYW5kbGVGb3JtU3VibWl0ID0gKGV2dCkgPT4ge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuX3JlbmRlckxvYWRpbmcoKTtcbiAgICB0aGlzLl9hY3Rpb25zRm9yU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCksIHRoaXMuX2J1dHRvbik7XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiLy8gZGVmYXVsdCBmb3JtIHNlbGVjdG9ycyBjb25maWd1cmF0aW9uLCB0byBiZSB1c2VkIGJ5IGZvcm0tdmFsaWRhdG9yXG5leHBvcnQgY29uc3QgZm9ybUNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlLWJ1dHRvbl9pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3N0YXRlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4gZmV0Y2godXJsLCBoZWFkZXJzKS50aGVuKChyZXMpID0+IChyZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cykpKTtcblxuZXhwb3J0IGNvbnN0IHBvcHVwRXJyb3JTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfZXJyb3JcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZVNlbGVjdG9yID0gXCIucHJvZmlsZV9fbmFtZVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZVNlbGVjdG9yID0gXCIucHJvZmlsZV9fdGl0bGVcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyU2VsZWN0b3IgPSBcIi5wcm9maWxlX19hdmF0YXJcIjtcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIik7XG5leHBvcnQgY29uc3Qgam9iSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX2pvYlwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbnB1dCA9IFwicG9wdXBfX2lucHV0X3R5cGVfYXZhdGFyLXNyY1wiO1xuZXhwb3J0IGNvbnN0IGVkaXRBdmF0YXJJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWF2YXRhci1pY29uXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwRWRpdFByb2ZpbGUgPSBcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiO1xuZXhwb3J0IGNvbnN0IGZvcm1FZGl0UHJvZmlsZSA9IFwiLnBvcHVwX19mb3JtX3R5cGVfZWRpdC1wcm9maWxlXCI7XG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcG9wdXBFZGl0QXZhdGFyID0gXCIucG9wdXBfdHlwZV9lZGl0LWF2YXRhclwiO1xuZXhwb3J0IGNvbnN0IGZvcm1FZGl0QXZhdGFyID0gXCIucG9wdXBfX2Zvcm1fdHlwZV9lZGl0LWF2YXRhclwiO1xuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItY292ZXJcIik7XG5leHBvcnQgY29uc3QgcG9wdXBDYXJkID0gXCIucGljdHVyZS1wb3B1cFwiO1xuZXhwb3J0IGNvbnN0IHBvcHVwRGVsZXRlQ2FyZFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9kZWxldGUtY2FyZFwiO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIjtcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGZvcm1BZGRDYXJkID0gXCIucG9wdXBfX2Zvcm1fdHlwZV9hZGQtY2FyZFwiO1xuIiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRpbmcgZWxlbWVudHMgYW5kIGNsYXNzZXMgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IGVkaXRBdmF0YXJJY29uU291cmNlIGZyb20gXCIuLi9pbWFnZXMvZWRpdF9pY29uLnN2Z1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aE1lc3NhZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoTWVzc2FnZS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IHsgZm9ybUNvbmZpZywgY3VzdG9tRmV0Y2gsIHBvcHVwRXJyb3JTZWxlY3RvciwgcHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZVRpdGxlU2VsZWN0b3IsIHByb2ZpbGVBdmF0YXJTZWxlY3RvciwgbmFtZUlucHV0LCBqb2JJbnB1dCwgYXZhdGFySW5wdXQsIGVkaXRBdmF0YXJJY29uLCBwb3B1cEVkaXRQcm9maWxlLCBmb3JtRWRpdFByb2ZpbGUsIGVkaXRCdXR0b24sIHBvcHVwRWRpdEF2YXRhciwgZm9ybUVkaXRBdmF0YXIsIGF2YXRhckVkaXRBcmVhLCBwb3B1cENhcmQsIHBvcHVwRGVsZXRlQ2FyZFNlbGVjdG9yLCBwb3B1cEFkZENhcmQsIGFkZENhcmRCdXR0b24sIGZvcm1BZGRDYXJkIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG4vLyBzZXR0aW5nIHVwIHRoZSBwb3B1cCBmb3IgZXJyb3IgbWVzc2FnZVxuY29uc3QgcG9wdXBFcnJvciA9IG5ldyBQb3B1cFdpdGhNZXNzYWdlKHBvcHVwRXJyb3JTZWxlY3Rvcik7XG5wb3B1cEVycm9yLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGVycm9yRnVuY3Rpb24gPSAoZXJyKSA9PiB7XG4gIGNvbnNvbGUubG9nKGBlcnJvcjogJHtlcnJ9YCk7XG4gIHBvcHVwRXJyb3IuZ2V0TWVzc2FnZShcIi5wb3B1cF9fdGV4dFwiLCBgZXJyb3I6ICR7ZXJyfWApO1xuICBwb3B1cEVycm9yLm9wZW4oKTtcbn07XG5cbi8vIHNldHRpbmcgdXAgdGhlIEFQSSBmb3IgY3VycmVudCB1c2VyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGN1c3RvbUZldGNoLCB7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIzZTYzYjE3YS02NDk3LTQyMjYtOTBjZi00ZDc5MzdiN2FiYTFcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZSBzZWN0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIHNldHRpbmcgdXAgdGhlIGVkaXQgaWNvbiBpbWFnZSB0aGF0IGFwcGVhcnMgd2hlbiBob3ZlcmluZyB0aGUgYXZhdGFyXG5lZGl0QXZhdGFySWNvbi5zcmMgPSBlZGl0QXZhdGFySWNvblNvdXJjZTtcblxuY29uc3QgdXNlclByb2ZpbGUgPSBuZXcgVXNlckluZm8ocHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZVRpdGxlU2VsZWN0b3IsIHByb2ZpbGVBdmF0YXJTZWxlY3Rvcik7XG5sZXQgdXNlcklkO1xuXG4vLyBsb2FkaW5nIHRoZSBwYWdlIGF0IG9uY2U6IHNldHRpbmcgdXAgcHJvZmlsZSBpbmZvIGZyb20gdGhlIHNlcnZlciBhbmQgcmVuZGVyaW5nIHRoZSBpbml0aWFsIGNhcmRzXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbdXNlckluZm8sIGluaXRpYWxDYXJkc10pID0+IHtcbiAgICAvLyBzZXR0aW5nIHVwIHByb2ZpbGUgaW5mbyBmcm9tIHRoZSBzZXJ2ZXJcbiAgICB1c2VySWQgPSB1c2VySW5mby5faWQ7XG4gICAgdXNlclByb2ZpbGUuc2V0VXNlckRhdGEodXNlckluZm8pO1xuICAgIHVzZXJQcm9maWxlLnNldFVzZXJBdmF0YXIodXNlckluZm8uYXZhdGFyKTtcblxuICAgIC8vIHJlbmRlcmluZyB0aGUgaW5pdGlhbCBjYXJkc1xuICAgIGNhcmRzTGlzdC5yZW5kZXJlcihpbml0aWFsQ2FyZHMpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gZXJyb3JGdW5jdGlvbihlcnIpKTtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAtZm9ybSBmb3IgZWRpdGluZyB0aGUgcHJvZmlsZVxuY29uc3QgcG9wdXBFZGl0UHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEVkaXRQcm9maWxlLCBmb3JtQ29uZmlnLCBoYW5kbGVFZGl0UHJvZmlsZUZvcm1TdWJtaXQpO1xucG9wdXBFZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gZGVjbGFyZSB0aGUgZnVjdGlvbiBmb3IgaGFuZGxpbmcgc3VibWl0IGZvciBlZGl0aW5nIGF2YXRhciBmb3JtXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZUZvcm1TdWJtaXQoZm9ybVZhbHVlcywgc3VibWl0QnV0dG9uKSB7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyhmb3JtVmFsdWVzKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJQcm9maWxlLnNldFVzZXJEYXRhKHJlcyk7XG4gICAgfSlcbiAgICAudGhlbigoKSA9PiBwb3B1cEVkaXRQcm9maWxlRm9ybS5jbG9zZSgpKVxuICAgIC5jYXRjaCgoZXJyKSA9PiBlcnJvckZ1bmN0aW9uKGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4gKHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiKSk7XG59XG5cbi8vIGhhbmRsZSBlZGl0LXByb2ZpbGUgZm9ybSBtb2RhbCBvcGVuXG5jb25zdCBvcGVuRWRpdFByb2ZpbGVGb3JtID0gKCkgPT4ge1xuICBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlclByb2ZpbGUuZ2V0VXNlckRhdGEoKTtcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgam9iSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5hYm91dDtcbiAgcG9wdXBFZGl0UHJvZmlsZUZvcm0ub3BlbigpO1xufTtcblxuLy8gZW5hYmxpbmcgdmFsaWRhdGlvbiBmb3IgZWRpdC1wcm9maWxlIGZvcm1cbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1FZGl0UHJvZmlsZSk7XG5lZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBldmVudCBsaXN0ZW5lcnMgZm9yIHByb21wdGluZyBwcm9maWxlLWVkaXQgcG9wdXAgd2hlbiBjbGlja2luZyB0aGUgZWRpdCBpY29uXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuRWRpdFByb2ZpbGVGb3JtKTtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAtZm9ybSBmb3IgZWRpdGluZyB0aGUgYXZhdGFyXG5jb25zdCBwb3B1cEVkaXRBdmF0YXJGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBFZGl0QXZhdGFyLCBmb3JtQ29uZmlnLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcbnBvcHVwRWRpdEF2YXRhckZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gZGVjbGFyZSB0aGUgZnVjdGlvbiBmb3IgaGFuZGxpbmcgc3VibWl0IGZvciBlZGl0aW5nIGF2YXRhciBmb3JtXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGF2YXRhclVybCwgc3VibWl0QnV0dG9uKSB7XG4gIGFwaVxuICAgIC5zZXRVc2VyQXZhdGFyKGF2YXRhclVybClcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VyUHJvZmlsZS5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4gcG9wdXBFZGl0QXZhdGFyRm9ybS5jbG9zZSgpKVxuICAgIC5jYXRjaCgoZXJyKSA9PiBlcnJvckZ1bmN0aW9uKGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4gKHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiKSk7XG59XG5cbi8vIGhhbmRsZSBlZGl0LWF2YXRhciBmb3JtIG1vZGFsIG9wZW5cbmNvbnN0IG9wZW5FZGl0QXZhdGFyRm9ybSA9ICgpID0+IHtcbiAgZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwRWRpdEF2YXRhckZvcm0ub3BlbigpO1xufTtcblxuLy8gZW5hYmxpbmcgdmFsaWRhdGlvbiBmb3IgZWRpdC1hdmF0YXIgZm9ybVxuY29uc3QgZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBmb3JtRWRpdEF2YXRhcik7XG5lZGl0QXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIGV2ZW50IGxpc3RlbmVycyBmb3IgcHJvbXB0aW5nIGF2YXRhci1lZGl0IHBvcHVwIHdoZW4gY2xpY2tpbmcgdGhlIGVkaXQgaWNvblxuYXZhdGFyRWRpdEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0QXZhdGFyRm9ybSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHMgc2VjdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLy8gc2V0dGluZyB1cCB0aGUgaW5pdGlhbCBpbWFnZSBwb3B1cFxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cENhcmQsIFwiIFwiLCBcIiBcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIHNldHRpbmcgdXAgdGhlIGluaXRpYWwgZGVsZXRlLWNhcmQgcG9wdXBcbmNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24ocG9wdXBEZWxldGVDYXJkU2VsZWN0b3IpO1xucG9wdXBEZWxldGVDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIGZ1bmN0aW9uIHRvIHJlbmRlciBhIG5ldyBjYXJkIGZyb20gZ2l2ZW4gZGF0YVxuY29uc3QgcmVuZGVyQ2FyZCA9IChjYXJkSXRlbSkgPT4ge1xuICBjb25zdCBwbGFjZUNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkSXRlbSxcbiAgICB1c2VySWQsXG4gICAgXCJjYXJkLXRlbXBsYXRlXCIsXG4gICAgLy8gZnVuY3Rpb24gdG8gYmUgcGVyZm9ybWVkIHdoZW4gY2xpY2tpbmcgb24gdGhlIG5ldyBjYXJkOlxuICAgICgpID0+IHtcbiAgICAgIGltYWdlUG9wdXAub3BlbihjYXJkSXRlbSk7XG4gICAgfSxcbiAgICAvLyBmdW5jdGlvbiB0byBiZSBwZXJmb3JtZWQgd2hlbiBjbGlja2luZyBvbiB0aGUgYmluIGljb24gb2YgdGhlIG5ldyBjYXJkOlxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIHBvcHVwRGVsZXRlQ2FyZC5vcGVuKCk7XG4gICAgICAvLyBmdW5jdGlvbiB0byBiZSBwZXJmb3JtZWQgd2hlbiBhcHByb3ZpbmcgdGhlIHBvcHVwIGZvciBkZWxldGluZyB0aGUgbmV3IGNhcmQ6XG4gICAgICBwb3B1cERlbGV0ZUNhcmQuc2V0U3VibWl0SGFuZGxlcigoKSA9PiB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcbiAgICAgICAgICAudGhlbigoKSA9PiBwbGFjZUNhcmQuZGVsZXRlQ2FyZEVsZW1lbnQoKSlcbiAgICAgICAgICAudGhlbigoKSA9PiBwb3B1cERlbGV0ZUNhcmQuY2xvc2UoKSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gZXJyb3JGdW5jdGlvbihlcnIpKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgLy8gZnVuY3Rpb24gdG8gYmUgcGVyZm9ybWVkIHdoZW4gY2xpY2tpbmcgb24gdGhlIGxpa2UgaWNvbiBvZiB0aGUgbmV3IGNhcmQ6XG4gICAgKGNhcmRJZCkgPT4ge1xuICAgICAgY29uc3QgaXNMaWtlZCA9IHBsYWNlQ2FyZC5pc0NhcmRMaWtlZCgpO1xuICAgICAgaWYgKGlzTGlrZWQpIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLnJlbW92ZUxpa2UoY2FyZElkKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHBsYWNlQ2FyZC51cGRhdGVMaWtlcyhyZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGVycm9yRnVuY3Rpb24oZXJyKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGlcbiAgICAgICAgICAuYWRkTGlrZShjYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgcGxhY2VDYXJkLnVwZGF0ZUxpa2VzKHJlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gZXJyb3JGdW5jdGlvbihlcnIpKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIGNvbnN0IHBsYWNlQ2FyZEVsZW1lbnQgPSBwbGFjZUNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gIGNhcmRzTGlzdC5hZGRJdGVtKHBsYWNlQ2FyZEVsZW1lbnQpO1xufTtcblxuLy8gc2V0dGluZyB1cCB0aGUgY2FyZHMgbGlzdCBzZWN0aW9uXG5jb25zdCBjYXJkc0xpc3QgPSBuZXcgU2VjdGlvbihyZW5kZXJDYXJkLCBcIi5waG90b3MtZ3JpZF9fbGlzdFwiKTtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAtZm9ybSBmb3IgcmVuZGVyaW5nIG5ldyBjYXJkc1xuY29uc3QgcG9wdXBBZGRDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwQWRkQ2FyZCwgZm9ybUNvbmZpZywgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQpO1xucG9wdXBBZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBkZWNsYXJlIHRoZSBmdWN0aW9uIGZvciBoYW5kbGluZyBzdWJtaXQgZm9yIGFkZGluZyBjYXJkIGZvcm1cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGZvcm1WYWx1ZXMsIHN1Ym1pdEJ1dHRvbikge1xuICBhcGlcbiAgICAuc2V0TmV3Q2FyZChmb3JtVmFsdWVzKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcbiAgICB9KVxuICAgIC50aGVuKCgpID0+IHBvcHVwQWRkQ2FyZEZvcm0uY2xvc2UoKSlcbiAgICAuY2F0Y2goKGVycikgPT4gZXJyb3JGdW5jdGlvbihlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IChzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkNyZWF0ZVwiKSk7XG59XG5cbi8vIGhhbmRsZSBhZGQtY2FyZCBmb3JtIG1vZGFsIG9wZW5cbmNvbnN0IG9wZW5BZGRDYXJkRm9ybSA9ICgpID0+IHtcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwQWRkQ2FyZEZvcm0ub3BlbigpO1xufTtcblxuLy8gZXZlbnQgbGlzdGVuZXJzIGZvciBwcm9tcHRpbmcgYWRkLWNhcmQgcG9wdXAgd2hlbiBjbGlja2luZyB0aGUgYWRkIGljb25cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5BZGRDYXJkRm9ybSk7XG5cbi8vIGVuYWJsaW5nIHZhbGlkYXRpb24gZm9yIGFkZC1jYXJkIGZvcm1cbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgZm9ybUFkZENhcmQpO1xuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhNZXNzYWdlIGV4dGVuZHMgUG9wdXAge1xuICBnZXRNZXNzYWdlKG1lc3NhZ2VGaWVsZCwgbWVzc2FnZSkge1xuICAgIHRoaXMuX21lc3NhZ2VGaWVsZCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IobWVzc2FnZUZpZWxkKTtcbiAgICB0aGlzLl9tZXNzYWdlRmllbGQudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihjdXN0b21GZXRjaCwgeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9jdXN0b21GZXRjaCA9IGN1c3RvbUZldGNoO1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8odXNlckRhdGEpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgc2V0TmV3Q2FyZChjYXJkRGF0YSkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBjYXJkRGF0YS5uYW1lLFxuICAgICAgICBsaW5rOiBjYXJkRGF0YS5saW5rLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVDYXJkID0gKGNhcmRJZCkgPT4ge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9O1xuXG4gIGFkZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXJMaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBhdmF0YXJMaW5rLmF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHVzZXJOYW1lU2VsZWN0b3IsIHVzZXJKb2JTZWxlY3RvciwgdXNlckF2YXRhclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJKb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJEYXRhKCkge1xuICAgIGNvbnN0IHVzZXJEYXRhID0ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICAgIHJldHVybiB1c2VyRGF0YTtcbiAgfVxuXG4gIHNldFVzZXJEYXRhKG5ld1VzZXJEYXRhKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuZXdVc2VyRGF0YS5uYW1lO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBuZXdVc2VyRGF0YS5hYm91dDtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyVXJsKSB7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7YXZhdGFyVXJsfSlgO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzb3VyY2UsIGNhcHRpb24pIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9zb3VyY2UgPSBzb3VyY2U7XG4gICAgdGhpcy5fY2FwdGlvbiA9IGNhcHRpb247XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucGljdHVyZS1wb3B1cF9fcG9wdXAtaW1hZ2VcIik7XG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5waWN0dXJlLXBvcHVwX19wb3B1cC10ZXh0XCIpO1xuICB9XG4gIG9wZW4obmV3UG9wdXBJbWFnZSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9zb3VyY2UgPSBuZXdQb3B1cEltYWdlLmxpbms7XG4gICAgdGhpcy5fY2FwdGlvbiA9IG5ld1BvcHVwSW1hZ2UubmFtZTtcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IHRoaXMuX3NvdXJjZTtcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IHRoaXMuX2NhcHRpb247XG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gdGhpcy5fY2FwdGlvbjtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIHNldFN1Ym1pdEhhbmRsZXIoaGFuZGxlcikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVyO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IocmVuZGVySXRlbSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9yZW5kZXJJdGVtID0gcmVuZGVySXRlbTtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuICByZW5kZXJlcihpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlckl0ZW0oaXRlbSk7XG4gICAgfSk7XG4gIH1cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInAiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwidXNlciIsInRlbXBsYXRlIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VCdXR0b24iLCJ0aGlzIiwiX2xpa2VzIiwibGlrZXMiLCJfbGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9saWtlc0NvdW50ZXIiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsIl90ZXh0IiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9saWtlc0NvdW50IiwiX293bmVyIiwib3duZXIiLCJfdXNlciIsIl90ZW1wbGF0ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9nZXRDYXJkRGF0YSIsImNvbnRlbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xvbmVOb2RlIiwiaXNDYXJkTGlrZWQiLCJzb21lIiwiZ2VuZXJhdGVDYXJkIiwiX2VsZW1lbnQiLCJfY2FyZFBob3RvIiwiX2NhcmRDYXB0aW9uIiwiX3RyYXNoSWNvbiIsInNyYyIsImFsdCIsImFkZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZWxldGVDYXJkRWxlbWVudCIsInJlbW92ZSIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2NvbmZpZyIsIl9mb3JtIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsIl9idXR0b25FbGVtZW50Iiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsIl9wb3B1cCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjbG9zZSIsIm9wZW4iLCJfaGFuZGxlQ2xpY2tPdmVybGF5Q2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiYWN0aW9uc0ZvclN1Ym1pdCIsInN1cGVyIiwiX3JlbmRlckxvYWRpbmciLCJfYWN0aW9uc0ZvclN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9idXR0b24iLCJfaW5wdXRzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJyZXNldCIsImZvcm1Db25maWciLCJmb3JtU2VsZWN0b3IiLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsImVkaXRBdmF0YXJJY29uIiwiZWRpdEJ1dHRvbiIsImF2YXRhckVkaXRBcmVhIiwiYWRkQ2FyZEJ1dHRvbiIsInBvcHVwRXJyb3IiLCJnZXRNZXNzYWdlIiwibWVzc2FnZUZpZWxkIiwibWVzc2FnZSIsIl9tZXNzYWdlRmllbGQiLCJlcnJvckZ1bmN0aW9uIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFwaSIsImN1c3RvbUZldGNoIiwiYmFzZVVybCIsImhlYWRlcnMiLCJjYXJkSWQiLCJfY3VzdG9tRmV0Y2giLCJfYmFzZVVybCIsIm1ldGhvZCIsIl9oZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJ1cGRhdGVVc2VySW5mbyIsInVzZXJEYXRhIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInNldE5ld0NhcmQiLCJjYXJkRGF0YSIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwic2V0VXNlckF2YXRhciIsImF2YXRhckxpbmsiLCJhdmF0YXIiLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsImVkaXRBdmF0YXJJY29uU291cmNlIiwidXNlclByb2ZpbGUiLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlckpvYlNlbGVjdG9yIiwidXNlckF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImdldFVzZXJEYXRhIiwic2V0VXNlckRhdGEiLCJuZXdVc2VyRGF0YSIsImF2YXRhclVybCIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwidXNlcklkIiwiYWxsIiwidXNlckluZm8iLCJpbml0aWFsQ2FyZHMiLCJjYXJkc0xpc3QiLCJyZW5kZXJlciIsImNhdGNoIiwicG9wdXBFZGl0UHJvZmlsZUZvcm0iLCJzdWJtaXRCdXR0b24iLCJmaW5hbGx5IiwiZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yIiwicG9wdXBFZGl0QXZhdGFyRm9ybSIsImVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yIiwiaW1hZ2VQb3B1cCIsInNvdXJjZSIsImNhcHRpb24iLCJfc291cmNlIiwiX2NhcHRpb24iLCJfcG9wdXBJbWFnZSIsIl9wb3B1cENhcHRpb24iLCJuZXdQb3B1cEltYWdlIiwicG9wdXBEZWxldGVDYXJkIiwic2V0U3VibWl0SGFuZGxlciIsImhhbmRsZXIiLCJyZW5kZXJDYXJkIiwiY2FyZEl0ZW0iLCJwbGFjZUNhcmQiLCJkZWxldGVDYXJkIiwidXBkYXRlTGlrZXMiLCJwbGFjZUNhcmRFbGVtZW50IiwiYWRkSXRlbSIsInJlbmRlckl0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJJdGVtIiwiX2NvbnRhaW5lciIsIml0ZW1zIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicG9wdXBBZGRDYXJkRm9ybSIsImFkZENhcmRGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==