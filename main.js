!function(){"use strict";var e={717:function(e,t,s){e.exports=s.p+"a086f758840ae814ecde.svg"}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.p="",function(){var e=s(717);function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e,s,r,o,i,n){t(this,"likeCard",(e=>{this._likes=e.likes,this._element.querySelector(".heart").classList.add("heart_active"),this._likesCounter.textContent=e.likes.length})),t(this,"removeLike",(e=>{this._likes=e.likes,this._element.querySelector(".heart").classList.remove("heart_active"),this._likesCounter.textContent=e.likes.length})),this._text=e.name,this._link=e.link,this._id=e._id,this._likes=e.likes,this._likesCount=e.likes.length,this._owner=e.owner._id,this._user=s,this._template=document.getElementById(r),this._handleCardClick=o,this._handleDeleteCard=i,this._handleLikeButton=n}_getCardData(){return this._template.content.querySelector(".photos-grid__card").cloneNode(!0)}isCardLiked(){return this._likes.some((e=>e._id===this._user))}generateCard(){return this._element=this._getCardData(),this._cardPhoto=this._element.querySelector(".photos-grid__photo"),this._cardCaption=this._element.querySelector(".photos-grid__location"),this._likesCounter=this._element.querySelector(".photos-grid__like-counter"),this._trashIcon=this._element.querySelector(".photos-grid__trash"),this._likesCounter.textContent=this._likesCount,this._cardPhoto.src=this._link,this._cardPhoto.alt=this._text,this._cardCaption.textContent=this._text,this._owner!==this._user&&this._trashIcon.classList.add("photos-grid__trash_disables"),this.isCardLiked()&&this._element.querySelector(".heart").classList.add("heart_active"),this._setEventListeners(),this._element}deleteCard(){this._element.remove(),this._element=null}_setEventListeners(){this._element.querySelector(".heart").addEventListener("click",(()=>this._handleLikeButton(this._id))),this._element.querySelector(".photos-grid__trash").addEventListener("click",(()=>this._handleDeleteCard(this._id))),this._element.querySelector(".photos-grid__photo").addEventListener("click",this._handleCardClick)}}class o{constructor(e,t){this._config=e,this._form=document.querySelector(t)}enableValidation(){this._inputList=[...this._form.querySelectorAll(this._config.inputSelector)],this._buttonElement=this._form.querySelector(this._config.submitButtonSelector),this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e),this._toggleButtonState()})),this._form.reset()}_showInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add(this._config.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n{constructor(e){i(this,"_handleEscClose",(e=>{"Escape"===e.key&&this._popup.classList.remove("popup_opened")})),i(this,"_handleClickOverlayClose",(e=>{e.target==e.currentTarget&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),this._popup.addEventListener("mousedown",this._handleClickOverlayClose),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),this._popup.removeEventListener("mousedown",this._handleClickOverlayClose),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.querySelector(".popup__close-button").addEventListener("click",(()=>this.close()))}}class a extends n{constructor(e,t){var s,r;super(e),r=e=>{e.preventDefault();const t=e.target.querySelector(".popup__save-button");t.textContent="Saving...",this._actionsForSubmit(this._getInputValues(),t)},(s="_handleFormSubmit")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._actionsForSubmit=t}_getInputValues(){const e={};return this._popup.querySelectorAll(".popup__input").forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",this._handleFormSubmit)}close(){this._popupForm.reset(),super.close()}}const _={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_inactive",inputErrorClass:"popup__input_state_error",errorClass:"popup__input-error_active"},c=document.getElementById("profile-avatar-edit"),h=document.querySelector(".profile__edit-button"),u=document.querySelector(".profile__avatar-cover"),p=document.querySelector(".profile__add-button"),l=new class extends n{getMessage(e,t){this._messageField=this._popup.querySelector(e),this._messageField.textContent=t}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this.close()}))}}(".popup_type_error");l.setEventListeners();const d=new class{constructor(e,t){let{baseUrl:s,headers:r,errorFunction:o}=t;this._customFetch=e,this._errorFunction=o,this._baseUrl=s,this._headers=r}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers},this._errorFunction)}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers},this._errorFunction)}updateUserInfo(e){return this._customFetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})},this._errorFunction)}setNewCard(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})},this._errorFunction)}deleteCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers},this._errorFunction)}addLike(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers},this._errorFunction)}removeLike(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers},this._errorFunction)}setUserAvatar(e){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})},this._errorFunction)}}(((e,t,s)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>{console.log("error: status code ".concat(e,".")),s("error: status code ".concat(e,"."))}))),{baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"3e63b17a-6497-4226-90cf-4d7937b7aba1","Content-Type":"application/json"},errorFunction:e=>{l.getMessage(".popup__text",e),l.open()}});c.src=e;const m=new class{constructor(e,t,s,r,o,i){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(s),this._formNameInput=document.querySelector(r),this._formJobInput=document.querySelector(o),this._formAvatarInput=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserInfo(e){this._formNameInput.value=e.name,this._formJobInput.value=e.about,this._nameElement.textContent=e.name,this._jobElement.textContent=e.about}setUserAvatar(e){this._avatarElement.style.backgroundImage="url(".concat(e,")")}}(".profile__name",".profile__title",".profile__avatar",".popup__input_type_name",".popup__input_type_job","popup__input_type_avatar-src");let v;Promise.all([d.getUserInfo(),d.getInitialCards()]).then((e=>{let[t,s]=e;v=t._id,m.setUserInfo(t),m.setUserAvatar(t.avatar),k.renderer(s)}));const f=new a(".popup_type_edit-profile",(function(e,t){d.updateUserInfo(e).then((()=>{m.setUserInfo(e),f.close()})).finally((()=>t.textContent="Save"))}));f.setEventListeners();const y=new o(_,".popup__form_type_edit-profile");y.enableValidation(),h.addEventListener("click",(()=>{y.resetValidation(),m.setUserInfo(m.getUserInfo()),f.open()}));const b=new a(".popup_type_edit-avatar",(function(e,t){d.setUserAvatar(e).then((e=>{m.setUserAvatar(e.avatar),b.close()})).finally((()=>t.textContent="Save"))}));b.setEventListeners();const g=new o(_,".popup__form_type_edit-avatar");g.enableValidation(),u.addEventListener("click",(()=>{g.resetValidation(),b.open()}));const C=new class extends n{constructor(e,t,s){super(e),this._source=t,this._caption=s}open(e){super.open(),this._source=e.link,this._caption=e.name,this._popupImage=this._popup.querySelector(".picture-popup__popup-image"),this._popupCaption=this._popup.querySelector(".picture-popup__popup-text"),this._popupImage.src=this._source,this._popupImage.alt=this._caption,this._popupCaption.textContent=this._caption}}(".picture-popup"," "," ");C.setEventListeners();const E=new class extends n{getTask(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._popupForm=this._popup.querySelector(".popup__form"),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(),this.close()}))}}(".popup_type_delete-card");E.setEventListeners();const L=e=>{const t=new r(e,v,"card-template",(()=>{C.open(e)}),(e=>{E.open(),E.getTask((()=>{d.deleteCard(e),t.deleteCard()}))}),(e=>{t.isCardLiked()?d.removeLike(e).then((e=>{t.removeLike(e)})):d.addLike(e).then((e=>{t.likeCard(e)}))})),s=t.generateCard();k.addItem(s)},k=new class{constructor(e,t){this._renderItem=e,this._container=document.querySelector(t)}renderer(e){e.forEach((e=>{this._renderItem(e)}))}addItem(e){this._container.prepend(e)}}(L,".photos-grid__list"),S=new a(".popup_type_add-card",(function(e,t){d.setNewCard(e).then((e=>{L(e),S.close()})).finally((()=>t.textContent="Create"))}));S.setEventListeners(),p.addEventListener("click",(()=>{I.resetValidation(),S.open()}));const I=new o(_,".popup__form_type_add-card");I.enableValidation()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGNBRXhCNEUsRUFBSXNCLFdBQVdGLEdBQVFRLE1BQU1DLElBQzNCdUQsRUFBVTlELFdBQVdPLE1BR3ZCN0IsRUFBSXFCLFFBQVFELEdBQVFRLE1BQU1DLElBQ3hCdUQsRUFBVUMsU0FBU3hELFNBS3JCeUQsRUFBbUJGLEVBQVU5SixlQUNuQzBJLEVBQVV1QixRQUFRRCxJQUlkdEIsRUFBWSxJTWxLSCxNQUNiaEwsWUFBWXdNLEVBQVlDLEdBQ3RCbE0sS0FBS21NLFlBQWNGLEVBQ25Cak0sS0FBS29NLFdBQWEvSyxTQUFTakIsY0FBYzhMLEdBRTNDeEIsU0FBUzJCLEdBQ1BBLEVBQU0vSSxTQUFTZ0osSUFDYnRNLEtBQUttTSxZQUFZRyxNQUdyQk4sUUFBUU8sR0FDTnZNLEtBQUtvTSxXQUFXSSxRQUFRRCxLTnVKRVosRUFBWSxzQkFHcENjLEVBQW1CLElBQUl0SCxFRG5JRCx3QkN1STVCLFNBQWlDTSxFQUFZSCxHQUMzQ21CLEVBQ0drQixXQUFXbEMsR0FDWDRDLE1BQU1DLElBQ0xxRCxFQUFXckQsR0FDWG1FLEVBQWlCNUgsV0FFbEIrRixTQUFRLElBQU90RixFQUFhOUUsWUFBYyxjQVYvQ2lNLEVBQWlCdkgsb0JBb0JqQmlCLEVBQWM1RCxpQkFBaUIsU0FOUCxLQUN0Qm1LLEVBQXFCckosa0JBQ3JCb0osRUFBaUIzSCxVQU9uQixNQUFNNEgsRUFBdUIsSUFBSWxLLEVBQWNzRCxFRHpKcEIsOEJDMEozQjRHLEVBQXFCN0osbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aE1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcmQgR2VuZXJhdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgdXNlciwgdGVtcGxhdGUsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQ2FyZCwgaGFuZGxlTGlrZUJ1dHRvbikge1xuICAgIHRoaXMuX3RleHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9saWtlc0NvdW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl91c2VyID0gdXNlcjtcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBsYXRlKTtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XG4gIH1cblxuICAvLyBjbG9uaW5nIG5ldyBjYXJkIGZyb20gdGVtcGxhdGUgYW5kIGFkZGluZyB0aGUgaW5mbyBmcm9tIGlucHV0XG4gIF9nZXRDYXJkRGF0YSgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5waG90b3MtZ3JpZF9fY2FyZFwiKS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgLy8gY2hlY2sgaWYgY2FyZCBpcyBsaWtlIHdoZW4gY2xpY2tpbmcgb24gdGhlIGxpa2UgaWNvblxuICBpc0NhcmRMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgodXNlcikgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXIpO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRDYXJkRGF0YSgpO1xuICAgIHRoaXMuX2NhcmRQaG90byA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90b3MtZ3JpZF9fcGhvdG9cIik7XG4gICAgdGhpcy5fY2FyZENhcHRpb24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zLWdyaWRfX2xvY2F0aW9uXCIpO1xuICAgIHRoaXMuX2xpa2VzQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90b3MtZ3JpZF9fbGlrZS1jb3VudGVyXCIpO1xuICAgIHRoaXMuX3RyYXNoSWNvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90b3MtZ3JpZF9fdHJhc2hcIik7XG4gICAgdGhpcy5fbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNDb3VudDtcbiAgICB0aGlzLl9jYXJkUGhvdG8uc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkUGhvdG8uYWx0ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9jYXJkQ2FwdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XG4gICAgaWYgKHRoaXMuX293bmVyICE9PSB0aGlzLl91c2VyKSB7XG4gICAgICB0aGlzLl90cmFzaEljb24uY2xhc3NMaXN0LmFkZChcInBob3Rvcy1ncmlkX190cmFzaF9kaXNhYmxlc1wiKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNDYXJkTGlrZWQoKSkge1xuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYXJ0XCIpLmNsYXNzTGlzdC5hZGQoXCJoZWFydF9hY3RpdmVcIik7XG4gICAgfVxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICAvLyBoYW5kbGUgZGVsZXRlIGZ1bmN0aW9uXG4gIGRlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAvLyByZW1vdmUgdGhlIGxpbmsgdG8gdGhlIERPTSBlbGVtZW50OlxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgLy8gYWRkIGV2ZW50IGxpc3RlbmVyc1xuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYXJ0XCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKHRoaXMuX2lkKSk7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3Rvcy1ncmlkX190cmFzaFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZCkpO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90b3MtZ3JpZF9fcGhvdG9cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XG4gIH1cblxuICAvLyBtYXJrIGxpa2UgaWNvbiBhbmQgdXBkYXRlIGxpa2UgY291bnRlclxuICBsaWtlQ2FyZCA9IChkYXRhKSA9PiB7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFydFwiKS5jbGFzc0xpc3QuYWRkKFwiaGVhcnRfYWN0aXZlXCIpO1xuICAgIHRoaXMuX2xpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xuICB9O1xuXG4gIC8vIHJlbW92ZSBsaWtlIGljb24gYW5kIHVwZGF0ZSBsaWtlIGNvdW50ZXJcbiAgcmVtb3ZlTGlrZSA9IChkYXRhKSA9PiB7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFydFwiKS5jbGFzc0xpc3QucmVtb3ZlKFwiaGVhcnRfYWN0aXZlXCIpO1xuICAgIHRoaXMuX2xpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xuICB9O1xufVxuIiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZvcm0gdmFsaWRhdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtKSB7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX2Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAvLyBzZXR0aW5nIGFuIGFycmF5IG9mIGFsbCBpbnB1dCBmaWVsZHMgb2YgYSBnaXZlbiBmb3JtXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3RvcildO1xuXG4gICAgLy8gZGVjbGFyaW5nIHRoZSBzdWJtaXQgYnV0dG9uIG9mIGEgZ2l2ZW4gZm9ybVxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgLy8gYWRkIHRoZSBhYmlsaXR5IHRvIHJlc2V0IHRoZSB2YWxpZGF0aW9uIGJldHdlZW4gc2Vzc2lvbnNcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIH0pO1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIC8vIHByb21wdGluZyBlcnJvciBtZXNzYWdlIHdpdGggaXRzIHN0eWxlIHBlciBmb3JtIGFuZCBpbnB1dCBmaWVsZFxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgfVxuXG4gIC8vIHJlbW92aW5nIHRoZSBlcnJvciBtZXNzYWdlXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgfVxuXG4gIC8vIGNoZWNraW5nIHRoZSB2YWxpZGl0eSBvZiBzcGVjaWZpYyBpbnB1dFxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIC8vIGNoZWNraW5nIHRoZSB2YWxpZGl0eSBvZiBlbnRpcmUgZm9ybVxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIC8vIHRvZ2dsaW5nIHRoZSBzdWJtaXQgYnV0dG9uIGFjdGl2ZSBvZiBpbmFjdGl2ZSwgdG8gYmUgdXNlZCBiYXNlZCBvbiBmb3JtIHZhbGlkaXR5XG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBhIGZ1bmN0aW9uIHRvIGFkZCBldmVudCBsaXN0ZW5lciBmb3IgZXZlcnkgZm9yIGlucHV0IGZpZWxkIGluIHRoZSBwYWdlXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBzZXR0aW5nIHRoZSBpbml0aWFsIHN0YXRlIG9mIHRoZSBzdWJtaXQgYnV0dG9uICh3aWxsIGJlIHNldCB0byBpbmFjdGl2ZSlcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgLy8gc2V0dGluZyBldmVudCBsaXN0ZW5lciBmb3IgZXZlcnkgaW5wdXQgZmllbGQgdG8gdGVzdCB2YWxpZGl0eSBhbmQgcmVzcG9uZCBhY2NvcmRpbmdseVxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIF9oYW5kbGVDbGlja092ZXJsYXlDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LnRhcmdldCA9PSBldnQuY3VycmVudFRhcmdldCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVDbGlja092ZXJsYXlDbG9zZSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICB0aGlzLl9wb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUNsaWNrT3ZlcmxheUNsb3NlKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgYWN0aW9uc0ZvclN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2FjdGlvbnNGb3JTdWJtaXQgPSBhY3Rpb25zRm9yU3VibWl0O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcbiAgfVxuXG4gIF9oYW5kbGVGb3JtU3VibWl0ID0gKGV2dCkgPT4ge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC50YXJnZXQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZS1idXR0b25cIik7XG4gICAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB0aGlzLl9hY3Rpb25zRm9yU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCksIHN1Ym1pdEJ1dHRvbik7XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiLy8gZGVmYXVsdCBmb3JtIHNlbGVjdG9ycyBjb25maWd1cmF0aW9uLCB0byBiZSB1c2VkIGJ5IGZvcm0tdmFsaWRhdG9yXG5leHBvcnQgY29uc3QgZm9ybUNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlLWJ1dHRvbl9pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3N0YXRlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycywgZXJyb3JGdW5jdGlvbikgPT5cbiAgZmV0Y2godXJsLCBoZWFkZXJzKVxuICAgIC50aGVuKChyZXMpID0+IChyZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cykpKVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgZXJyb3I6IHN0YXR1cyBjb2RlICR7ZXJyfS5gKTtcbiAgICAgIGVycm9yRnVuY3Rpb24oYGVycm9yOiBzdGF0dXMgY29kZSAke2Vycn0uYCk7XG4gICAgfSk7XG5cbmV4cG9ydCBjb25zdCBwb3B1cEVycm9yU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2Vycm9yXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWVTZWxlY3RvciA9IFwiLnByb2ZpbGVfX25hbWVcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVTZWxlY3RvciA9IFwiLnByb2ZpbGVfX3RpdGxlXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhclNlbGVjdG9yID0gXCIucHJvZmlsZV9fYXZhdGFyXCI7XG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiO1xuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gXCIucG9wdXBfX2lucHV0X3R5cGVfam9iXCI7XG5leHBvcnQgY29uc3QgYXZhdGFySW5wdXQgPSBcInBvcHVwX19pbnB1dF90eXBlX2F2YXRhci1zcmNcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyRWRpdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1hdmF0YXItZWRpdFwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gXCIucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGVcIjtcbmV4cG9ydCBjb25zdCBmb3JtRWRpdFByb2ZpbGUgPSBcIi5wb3B1cF9fZm9ybV90eXBlX2VkaXQtcHJvZmlsZVwiO1xuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IFwiLnBvcHVwX3R5cGVfZWRpdC1hdmF0YXJcIjtcbmV4cG9ydCBjb25zdCBmb3JtRWRpdEF2YXRhciA9IFwiLnBvcHVwX19mb3JtX3R5cGVfZWRpdC1hdmF0YXJcIjtcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWNvdmVyXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwQ2FyZCA9IFwiLnBpY3R1cmUtcG9wdXBcIjtcbmV4cG9ydCBjb25zdCBwb3B1cERlbGV0ZUNhcmRTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfZGVsZXRlLWNhcmRcIjtcbmV4cG9ydCBjb25zdCBwb3B1cEFkZENhcmQgPSBcIi5wb3B1cF90eXBlX2FkZC1jYXJkXCI7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBmb3JtQWRkQ2FyZCA9IFwiLnBvcHVwX19mb3JtX3R5cGVfYWRkLWNhcmRcIjtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0aW5nIGVsZW1lbnRzIGFuZCBjbGFzc2VzICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBwcm9maWxlQXZhdGFyRWRpdFNvdXJjZSBmcm9tIFwiLi4vaW1hZ2VzL2VkaXRfaWNvbi5zdmdcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhNZXNzYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aE1lc3NhZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7IGZvcm1Db25maWcsIGN1c3RvbUZldGNoLCBwb3B1cEVycm9yU2VsZWN0b3IsIHByb2ZpbGVOYW1lU2VsZWN0b3IsIHByb2ZpbGVUaXRsZVNlbGVjdG9yLCBwcm9maWxlQXZhdGFyU2VsZWN0b3IsIG5hbWVJbnB1dCwgam9iSW5wdXQsIGF2YXRhcklucHV0LCBwcm9maWxlQXZhdGFyRWRpdCwgcG9wdXBFZGl0UHJvZmlsZSwgZm9ybUVkaXRQcm9maWxlLCBlZGl0QnV0dG9uLCBwb3B1cEVkaXRBdmF0YXIsIGZvcm1FZGl0QXZhdGFyLCBhdmF0YXJFZGl0QXJlYSwgcG9wdXBDYXJkLCBwb3B1cERlbGV0ZUNhcmRTZWxlY3RvciwgcG9wdXBBZGRDYXJkLCBhZGRDYXJkQnV0dG9uLCBmb3JtQWRkQ2FyZCB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAgZm9yIGVycm9yIG1lc3NhZ2VcbmNvbnN0IHBvcHVwRXJyb3IgPSBuZXcgUG9wdXBXaXRoTWVzc2FnZShwb3B1cEVycm9yU2VsZWN0b3IpO1xucG9wdXBFcnJvci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBzZXR0aW5nIHVwIHRoZSBBUEkgZm9yIGN1cnJlbnQgdXNlclxuY29uc3QgYXBpID0gbmV3IEFwaShjdXN0b21GZXRjaCwge1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiM2U2M2IxN2EtNjQ5Ny00MjI2LTkwY2YtNGQ3OTM3YjdhYmExXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG4gIGVycm9yRnVuY3Rpb246IChlcnJNZXNzYWdlKSA9PiB7XG4gICAgcG9wdXBFcnJvci5nZXRNZXNzYWdlKFwiLnBvcHVwX190ZXh0XCIsIGVyck1lc3NhZ2UpO1xuICAgIHBvcHVwRXJyb3Iub3BlbigpO1xuICB9LFxufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9maWxlIHNlY3Rpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLy8gc2V0dGluZyB1cCB0aGUgaW5pdGlhbCBwcm9maWxlIGluZm9cbnByb2ZpbGVBdmF0YXJFZGl0LnNyYyA9IHByb2ZpbGVBdmF0YXJFZGl0U291cmNlO1xuXG5jb25zdCB1c2VyUHJvZmlsZSA9IG5ldyBVc2VySW5mbyhwcm9maWxlTmFtZVNlbGVjdG9yLCBwcm9maWxlVGl0bGVTZWxlY3RvciwgcHJvZmlsZUF2YXRhclNlbGVjdG9yLCBuYW1lSW5wdXQsIGpvYklucHV0LCBhdmF0YXJJbnB1dCk7XG5sZXQgdXNlcklkO1xuXG4vLyBsb2FkaW5nIHRoZSBwYWdlIGF0IG9uY2U6IHNldHRpbmcgdXAgcHJvZmlsZSBpbmZvIGZyb20gdGhlIHNlcnZlciBhbmQgcmVuZGVyaW5nIHRoZSBpbml0aWFsIGNhcmRzXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pLnRoZW4oKFt1c2VySW5mbywgaW5pdGlhbENhcmRzXSkgPT4ge1xuICAvLyBzZXR0aW5nIHVwIHByb2ZpbGUgaW5mbyBmcm9tIHRoZSBzZXJ2ZXJcbiAgdXNlcklkID0gdXNlckluZm8uX2lkO1xuICB1c2VyUHJvZmlsZS5zZXRVc2VySW5mbyh1c2VySW5mbyk7XG4gIHVzZXJQcm9maWxlLnNldFVzZXJBdmF0YXIodXNlckluZm8uYXZhdGFyKTtcblxuICAvLyByZW5kZXJpbmcgdGhlIGluaXRpYWwgY2FyZHNcbiAgY2FyZHNMaXN0LnJlbmRlcmVyKGluaXRpYWxDYXJkcyk7XG59KTtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAtZm9ybSBmb3IgZWRpdGluZyB0aGUgcHJvZmlsZVxuY29uc3QgcG9wdXBFZGl0UHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEVkaXRQcm9maWxlLCBoYW5kbGVFZGl0UHJvZmlsZUZvcm1TdWJtaXQpO1xucG9wdXBFZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gZGVjbGFyZSB0aGUgZnVjdGlvbiBmb3IgaGFuZGxpbmcgc3VibWl0IGZvciBlZGl0aW5nIGF2YXRhciBmb3JtXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZUZvcm1TdWJtaXQoZm9ybVZhbHVlcywgc3VibWl0QnV0dG9uKSB7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyhmb3JtVmFsdWVzKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKGZvcm1WYWx1ZXMpO1xuICAgICAgcG9wdXBFZGl0UHJvZmlsZUZvcm0uY2xvc2UoKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IChzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIikpO1xufVxuXG4vLyBoYW5kbGUgZWRpdC1wcm9maWxlIGZvcm0gbW9kYWwgb3BlblxuY29uc3Qgb3BlbkVkaXRQcm9maWxlRm9ybSA9ICgpID0+IHtcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICB1c2VyUHJvZmlsZS5zZXRVc2VySW5mbyh1c2VyUHJvZmlsZS5nZXRVc2VySW5mbygpKTtcbiAgcG9wdXBFZGl0UHJvZmlsZUZvcm0ub3BlbigpO1xufTtcblxuLy8gZW5hYmxpbmcgdmFsaWRhdGlvbiBmb3IgZWRpdC1wcm9maWxlIGZvcm1cbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGZvcm1FZGl0UHJvZmlsZSk7XG5lZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBldmVudCBsaXN0ZW5lcnMgZm9yIHByb21wdGluZyBwcm9maWxlLWVkaXQgcG9wdXAgd2hlbiBjbGlja2luZyB0aGUgZWRpdCBpY29uXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuRWRpdFByb2ZpbGVGb3JtKTtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAtZm9ybSBmb3IgZWRpdGluZyB0aGUgYXZhdGFyXG5jb25zdCBwb3B1cEVkaXRBdmF0YXJGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBFZGl0QXZhdGFyLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcbnBvcHVwRWRpdEF2YXRhckZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gZGVjbGFyZSB0aGUgZnVjdGlvbiBmb3IgaGFuZGxpbmcgc3VibWl0IGZvciBlZGl0aW5nIGF2YXRhciBmb3JtXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGF2YXRhclVybCwgc3VibWl0QnV0dG9uKSB7XG4gIGFwaVxuICAgIC5zZXRVc2VyQXZhdGFyKGF2YXRhclVybClcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VyUHJvZmlsZS5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xuICAgICAgcG9wdXBFZGl0QXZhdGFyRm9ybS5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4gKHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiKSk7XG59XG5cbi8vIGhhbmRsZSBlZGl0LWF2YXRhciBmb3JtIG1vZGFsIG9wZW5cbmNvbnN0IG9wZW5FZGl0QXZhdGFyRm9ybSA9ICgpID0+IHtcbiAgZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwRWRpdEF2YXRhckZvcm0ub3BlbigpO1xufTtcblxuLy8gZW5hYmxpbmcgdmFsaWRhdGlvbiBmb3IgZWRpdC1hdmF0YXIgZm9ybVxuY29uc3QgZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBmb3JtRWRpdEF2YXRhcik7XG5lZGl0QXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIGV2ZW50IGxpc3RlbmVycyBmb3IgcHJvbXB0aW5nIGF2YXRhci1lZGl0IHBvcHVwIHdoZW4gY2xpY2tpbmcgdGhlIGVkaXQgaWNvblxuYXZhdGFyRWRpdEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0QXZhdGFyRm9ybSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHMgc2VjdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLy8gc2V0dGluZyB1cCB0aGUgaW5pdGlhbCBpbWFnZSBwb3B1cFxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cENhcmQsIFwiIFwiLCBcIiBcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIHNldHRpbmcgdXAgdGhlIGluaXRpYWwgZGVsZXRlLWNhcmQgcG9wdXBcbmNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24ocG9wdXBEZWxldGVDYXJkU2VsZWN0b3IpO1xucG9wdXBEZWxldGVDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIGZ1bmN0aW9uIHRvIHJlbmRlciBhIG5ldyBjYXJkIGZyb20gZ2l2ZW4gZGF0YVxuY29uc3QgcmVuZGVyQ2FyZCA9IChjYXJkSXRlbSkgPT4ge1xuICBjb25zdCBwbGFjZUNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkSXRlbSxcbiAgICB1c2VySWQsXG4gICAgXCJjYXJkLXRlbXBsYXRlXCIsXG4gICAgLy8gZnVuY3Rpb24gdG8gYmUgcGVyZm9ybWVkIHdoZW4gY2xpY2tpbmcgb24gdGhlIG5ldyBjYXJkOlxuICAgICgpID0+IHtcbiAgICAgIGltYWdlUG9wdXAub3BlbihjYXJkSXRlbSk7XG4gICAgfSxcbiAgICAvLyBmdW5jdGlvbiB0byBiZSBwZXJmb3JtZWQgd2hlbiBjbGlja2luZyBvbiB0aGUgYmluIGljb24gb2YgdGhlIG5ldyBjYXJkOlxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIHBvcHVwRGVsZXRlQ2FyZC5vcGVuKCk7XG4gICAgICAvLyBmdW5jdGlvbiB0byBiZSBwZXJmb3JtZWQgd2hlbiBhcHByb3ZpbmcgdGhlIHBvcHVwIGZvciBkZWxldGluZyB0aGUgbmV3IGNhcmQ6XG4gICAgICBwb3B1cERlbGV0ZUNhcmQuZ2V0VGFzaygoKSA9PiB7XG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZCk7XG4gICAgICAgIHBsYWNlQ2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIC8vIGZ1bmN0aW9uIHRvIGJlIHBlcmZvcm1lZCB3aGVuIGNsaWNraW5nIG9uIHRoZSBsaWtlIGljb24gb2YgdGhlIG5ldyBjYXJkOlxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIGNvbnN0IGlzTGlrZWQgPSBwbGFjZUNhcmQuaXNDYXJkTGlrZWQoKTtcbiAgICAgIGlmIChpc0xpa2VkKSB7XG4gICAgICAgIGFwaS5yZW1vdmVMaWtlKGNhcmRJZCkudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgcGxhY2VDYXJkLnJlbW92ZUxpa2UocmVzKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGkuYWRkTGlrZShjYXJkSWQpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIHBsYWNlQ2FyZC5saWtlQ2FyZChyZXMpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIGNvbnN0IHBsYWNlQ2FyZEVsZW1lbnQgPSBwbGFjZUNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gIGNhcmRzTGlzdC5hZGRJdGVtKHBsYWNlQ2FyZEVsZW1lbnQpO1xufTtcblxuLy8gc2V0dGluZyB1cCB0aGUgY2FyZHMgbGlzdCBzZWN0aW9uXG5jb25zdCBjYXJkc0xpc3QgPSBuZXcgU2VjdGlvbihyZW5kZXJDYXJkLCBcIi5waG90b3MtZ3JpZF9fbGlzdFwiKTtcblxuLy8gc2V0dGluZyB1cCB0aGUgcG9wdXAtZm9ybSBmb3IgcmVuZGVyaW5nIG5ldyBjYXJkc1xuY29uc3QgcG9wdXBBZGRDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwQWRkQ2FyZCwgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQpO1xucG9wdXBBZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBkZWNsYXJlIHRoZSBmdWN0aW9uIGZvciBoYW5kbGluZyBzdWJtaXQgZm9yIGFkZGluZyBjYXJkIGZvcm1cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGZvcm1WYWx1ZXMsIHN1Ym1pdEJ1dHRvbikge1xuICBhcGlcbiAgICAuc2V0TmV3Q2FyZChmb3JtVmFsdWVzKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcbiAgICAgIHBvcHVwQWRkQ2FyZEZvcm0uY2xvc2UoKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IChzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkNyZWF0ZVwiKSk7XG59XG5cbi8vIGhhbmRsZSBhZGQtY2FyZCBmb3JtIG1vZGFsIG9wZW5cbmNvbnN0IG9wZW5BZGRDYXJkRm9ybSA9ICgpID0+IHtcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwQWRkQ2FyZEZvcm0ub3BlbigpO1xufTtcblxuLy8gZXZlbnQgbGlzdGVuZXJzIGZvciBwcm9tcHRpbmcgYWRkLWNhcmQgcG9wdXAgd2hlbiBjbGlja2luZyB0aGUgYWRkIGljb25cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5BZGRDYXJkRm9ybSk7XG5cbi8vIGVuYWJsaW5nIHZhbGlkYXRpb24gZm9yIGFkZC1jYXJkIGZvcm1cbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgZm9ybUFkZENhcmQpO1xuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhNZXNzYWdlIGV4dGVuZHMgUG9wdXAge1xuICBnZXRNZXNzYWdlKG1lc3NhZ2VGaWVsZCwgbWVzc2FnZSkge1xuICAgIHRoaXMuX21lc3NhZ2VGaWVsZCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IobWVzc2FnZUZpZWxkKTtcbiAgICB0aGlzLl9tZXNzYWdlRmllbGQudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihjdXN0b21GZXRjaCwgeyBiYXNlVXJsLCBoZWFkZXJzLCBlcnJvckZ1bmN0aW9uIH0pIHtcbiAgICB0aGlzLl9jdXN0b21GZXRjaCA9IGN1c3RvbUZldGNoO1xuICAgIHRoaXMuX2Vycm9yRnVuY3Rpb24gPSBlcnJvckZ1bmN0aW9uO1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChcbiAgICAgIGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCxcbiAgICAgIHtcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChcbiAgICAgIGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCxcbiAgICAgIHtcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJJbmZvKHVzZXJEYXRhKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKFxuICAgICAgYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxuXG4gIHNldE5ld0NhcmQoY2FyZERhdGEpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goXG4gICAgICBgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBuYW1lOiBjYXJkRGF0YS5uYW1lLFxuICAgICAgICAgIGxpbms6IGNhcmREYXRhLmxpbmssXG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICAgIHRoaXMuX2Vycm9yRnVuY3Rpb25cbiAgICApO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goXG4gICAgICBgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICB9LFxuICAgICAgdGhpcy5fZXJyb3JGdW5jdGlvblxuICAgICk7XG4gIH1cblxuICBhZGRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChcbiAgICAgIGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKFxuICAgICAgYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgfSxcbiAgICAgIHRoaXMuX2Vycm9yRnVuY3Rpb25cbiAgICApO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXJMaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKFxuICAgICAgYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBhdmF0YXI6IGF2YXRhckxpbmsuYXZhdGFyLFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICB0aGlzLl9lcnJvckZ1bmN0aW9uXG4gICAgKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZVNlbGVjdG9yLCB1c2VySm9iU2VsZWN0b3IsIHVzZXJBdmF0YXJTZWxlY3RvciwgZm9ybU5hbWVJbnB1dCwgZm9ybUpvYklucHV0LCBmb3JtQXZhdGFySW5wdXQpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1OYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm1OYW1lSW5wdXQpO1xuICAgIHRoaXMuX2Zvcm1Kb2JJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybUpvYklucHV0KTtcbiAgICB0aGlzLl9mb3JtQXZhdGFySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm1BdmF0YXJJbnB1dCk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB1c2VyRGF0YSA9IHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgICByZXR1cm4gdXNlckRhdGE7XG4gIH1cblxuICBzZXRVc2VySW5mbyhuZXdVc2VyRGF0YSkge1xuICAgIHRoaXMuX2Zvcm1OYW1lSW5wdXQudmFsdWUgPSBuZXdVc2VyRGF0YS5uYW1lO1xuICAgIHRoaXMuX2Zvcm1Kb2JJbnB1dC52YWx1ZSA9IG5ld1VzZXJEYXRhLmFib3V0O1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmV3VXNlckRhdGEubmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gbmV3VXNlckRhdGEuYWJvdXQ7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKGF2YXRhclVybCkge1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke2F2YXRhclVybH0pYDtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc291cmNlLCBjYXB0aW9uKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fc291cmNlID0gc291cmNlO1xuICAgIHRoaXMuX2NhcHRpb24gPSBjYXB0aW9uO1xuICB9XG4gIG9wZW4obmV3UG9wdXBJbWFnZSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9zb3VyY2UgPSBuZXdQb3B1cEltYWdlLmxpbms7XG4gICAgdGhpcy5fY2FwdGlvbiA9IG5ld1BvcHVwSW1hZ2UubmFtZTtcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5waWN0dXJlLXBvcHVwX19wb3B1cC1pbWFnZVwiKTtcbiAgICB0aGlzLl9wb3B1cENhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBpY3R1cmUtcG9wdXBfX3BvcHVwLXRleHRcIik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSB0aGlzLl9zb3VyY2U7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSB0aGlzLl9jYXB0aW9uO1xuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuX2NhcHRpb247XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBnZXRUYXNrKHRhc2spIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gdGFzaztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHJlbmRlckl0ZW0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVySXRlbSA9IHJlbmRlckl0ZW07XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cbiAgcmVuZGVyZXIoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJJdGVtKGl0ZW0pO1xuICAgIH0pO1xuICB9XG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJwIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXIiLCJ0ZW1wbGF0ZSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlQnV0dG9uIiwidGhpcyIsIl9saWtlcyIsImxpa2VzIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2xpa2VzQ291bnRlciIsInRleHRDb250ZW50IiwibGVuZ3RoIiwicmVtb3ZlIiwiX3RleHQiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2xpa2VzQ291bnQiLCJfb3duZXIiLCJvd25lciIsIl91c2VyIiwiX3RlbXBsYXRlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2dldENhcmREYXRhIiwiY29udGVudCIsImNsb25lTm9kZSIsImlzQ2FyZExpa2VkIiwic29tZSIsImdlbmVyYXRlQ2FyZCIsIl9jYXJkUGhvdG8iLCJfY2FyZENhcHRpb24iLCJfdHJhc2hJY29uIiwic3JjIiwiYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZGVsZXRlQ2FyZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybSIsIl9jb25maWciLCJfZm9ybSIsImVuYWJsZVZhbGlkYXRpb24iLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwicmVzZXQiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsIl9wb3B1cCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjbG9zZSIsIm9wZW4iLCJfaGFuZGxlQ2xpY2tPdmVybGF5Q2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiYWN0aW9uc0ZvclN1Ym1pdCIsInN1cGVyIiwic3VibWl0QnV0dG9uIiwiX2FjdGlvbnNGb3JTdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsImZvcm1Db25maWciLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlQXZhdGFyRWRpdCIsImVkaXRCdXR0b24iLCJhdmF0YXJFZGl0QXJlYSIsImFkZENhcmRCdXR0b24iLCJwb3B1cEVycm9yIiwiZ2V0TWVzc2FnZSIsIm1lc3NhZ2VGaWVsZCIsIm1lc3NhZ2UiLCJfbWVzc2FnZUZpZWxkIiwiYXBpIiwiY3VzdG9tRmV0Y2giLCJiYXNlVXJsIiwiaGVhZGVycyIsImVycm9yRnVuY3Rpb24iLCJfY3VzdG9tRmV0Y2giLCJfZXJyb3JGdW5jdGlvbiIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsInVwZGF0ZVVzZXJJbmZvIiwidXNlckRhdGEiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0Iiwic2V0TmV3Q2FyZCIsImNhcmREYXRhIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJzZXRVc2VyQXZhdGFyIiwiYXZhdGFyTGluayIsImF2YXRhciIsInVybCIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhdXRob3JpemF0aW9uIiwiZXJyTWVzc2FnZSIsInByb2ZpbGVBdmF0YXJFZGl0U291cmNlIiwidXNlclByb2ZpbGUiLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlckpvYlNlbGVjdG9yIiwidXNlckF2YXRhclNlbGVjdG9yIiwiZm9ybU5hbWVJbnB1dCIsImZvcm1Kb2JJbnB1dCIsImZvcm1BdmF0YXJJbnB1dCIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJfZm9ybU5hbWVJbnB1dCIsIl9mb3JtSm9iSW5wdXQiLCJfZm9ybUF2YXRhcklucHV0Iiwic2V0VXNlckluZm8iLCJuZXdVc2VyRGF0YSIsImF2YXRhclVybCIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwidXNlcklkIiwiYWxsIiwidXNlckluZm8iLCJpbml0aWFsQ2FyZHMiLCJjYXJkc0xpc3QiLCJyZW5kZXJlciIsInBvcHVwRWRpdFByb2ZpbGVGb3JtIiwiZmluYWxseSIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsInBvcHVwRWRpdEF2YXRhckZvcm0iLCJlZGl0QXZhdGFyRm9ybVZhbGlkYXRvciIsImltYWdlUG9wdXAiLCJzb3VyY2UiLCJjYXB0aW9uIiwiX3NvdXJjZSIsIl9jYXB0aW9uIiwibmV3UG9wdXBJbWFnZSIsIl9wb3B1cEltYWdlIiwiX3BvcHVwQ2FwdGlvbiIsInBvcHVwRGVsZXRlQ2FyZCIsImdldFRhc2siLCJ0YXNrIiwicmVuZGVyQ2FyZCIsImNhcmRJdGVtIiwicGxhY2VDYXJkIiwibGlrZUNhcmQiLCJwbGFjZUNhcmRFbGVtZW50IiwiYWRkSXRlbSIsInJlbmRlckl0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJJdGVtIiwiX2NvbnRhaW5lciIsIml0ZW1zIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicG9wdXBBZGRDYXJkRm9ybSIsImFkZENhcmRGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==